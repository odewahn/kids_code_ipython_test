(function(){self.JSREPLEngine=function(){function c(a,b,g,d,e,h){this.input=a;this.output=b;this.error=d;this.sandbox=e;this.result_fn_factory=function(a){return function(b){var f,g,d,e;e="";for(g in b)f=b[g],d=f.toString(),f=d.length-74,f=f>0?f:0,d=d.slice(f),f>0&&(d="..."+d),e+="\n"+g+": "+d;return a(e)}};this.result_handler=this.result_fn_factory(g);this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler});h()}c.prototype.Eval=
function(a){var b;try{if(a.match(/^RESET\b/))this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler}),a=a.replace(/^RESET/,"");b=new this.sandbox.Emoticon.Parser(a);this.interpreter.lists.Z=this.interpreter.lists.Z.concat(b);return this.interpreter.run()}catch(g){return this.error(g)}};c.prototype.EvalSync=function(a){var b;this.interpreter.lists.Z=this.interpreter.lists.Z.concat(new this.sandbox.Emoticon.Parser(a));b=null;this.interpreter.result=
this.result_fn_factory(function(a){return b=a});this.interpreter.run();this.interpreter.result=this.result_handler;return b};c.prototype.GetNextLineIndent=function(a){var b;b=function(a){return function(b){var e,h,c,i;h=new a.sandbox.Emoticon.Parser(b);b=0;for(c=0,i=h.length;c<i;c++)if(e=h[c],e.mouth)switch(e.mouth){case "(":++b;break;case ")":--b}return b}}(this);return b(a)<=0?false:(a=b(a.split("\n").slice(-1)[0]),a>0?1:a<0?a:0)};return c}()}).call(this);
