(function(){self.JSREPLEngine=function(){function b(a,c,j,g,f,b){var h,i;this.error=g;this.sandbox=f;h=function(l){return function(){return a(function(a){return l.machine.resume(a)})}}(this);i=function(a){return function(d){c(d);return a.machine.resume()}}(this);f=function(a){return function(d){g(d);a.machine.reset();a.machine.halted=true;return a.machine.instruction_ptr=a.machine.instructions.length}}(this);this.result_handler=function(a){return function(){var d;d=a.machine.frames[0].variables.IT;
return d===a.last_it?j(""):(a.last_it=d,j(d.value===null?"":String(d.value)))}}(this);this.context=new this.sandbox.LOLCoffee.CodeGenContext;this.machine=new this.sandbox.LOLCoffee.Machine(this.context,h,i,f,this.result_handler,true);this.last_it=null;b()}b.prototype.Compile=function(a){return(new this.sandbox.LOLCoffee.Parser((new this.sandbox.LOLCoffee.Tokenizer(a)).tokenize())).parseProgram().codegen(this.context)};b.prototype.Eval=function(a){try{this.Compile(a)}catch(c){this.error(c);return}return this.machine.run()};
b.prototype.EvalSync=function(a){this.Compile(a);this.machine.done=function(){};this.machine.run();this.machine.done=this.result_handler;a=this.machine.frames[0].variables.IT;return a===this.last_it?null:(this.last_it=a,a.value)};b.prototype.GetNextLineIndent=function(a){var c,b,g,f,k;if(/\.\.\.\s*$/.test(a))return 0;try{c=(new this.sandbox.LOLCoffee.Tokenizer(a)).tokenize()}catch(h){return false}try{return(new this.sandbox.LOLCoffee.Parser(c.slice(0))).parseProgram(),false}catch(i){a=[];b=[];for(f=
0,k=c.length;f<k;f++)g=c[f],g.type==="endline"?(a.push(b),b=[]):b.push(g);c=function(a,d){var b,e,c,f;d==null&&(d=false);e=[];for(c=0,f=a.length;c<f;c++)switch(b=a[c],b[0].text){case "HAI":e.push("KTHXBYE");break;case "HOW DUZ I":e.push("IF U SAY SO");break;case "IM IN YR":e.push("IM OUTTA YR");break;case "O RLY?":case "WTF?":e.push("OIC");break;case "YA RLY":case "NO WAI":case "MEBBE":if(d&&e.length===0)e.push("OIC");else if(e[e.length-1]!=="OIC")return-1;break;case "KTHXBYE":case "IF U SAY SO":case "IM OUTTA YR":case "OIC":if(e[e.length-
1]===b[0].text)e.pop();else return-1}return e.length};return c(a)<=0?false:c([a.slice(-1)[0]],true)>0?1:0}};return b}()}).call(this);
