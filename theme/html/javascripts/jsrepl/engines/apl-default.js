(function(){var aD,av,D,Q,K,j,aL,q,h,ao,E,M,O,H,aA,aw,b,au,U,aB,v,aE,A,aG,N,ar,d,ab,a,ax,T,ah,ae,p,s,G,aq,I,c,aI,ay,am,al,ap,x,af,az,ak,C,l,e,aH,at,i,P,X,ag,Y,an,V,w,aC,ai,o,u,f,g,R,ad,aj,t,W,y,aa,L,n,ac,F,aK,J,B,Z,z,aM,S,aJ,m,k,r=[].slice,aF=[].indexOf||function(aP){for(var aO=0,aN=this.length;aO<aN;aO++){if(aO in this&&this[aO]===aP){return aO}}return -1};aC=function(aP){var aQ,aN,aR,aO;aQ=1;for(aR=0,aO=aP.length;aR<aO;aR++){aN=aP[aR];aQ*=aN}return aQ};aE=function(aP){var aN,aQ,aO;for(aQ=0,aO=aP.length;aQ<aO;aQ++){aN=aP[aQ];if(!aN){return false}}return true};u=function(aO,aQ){var aN,aP;if(!(aO.length!=null)){throw Error('"assert a.length?" at src/helpers.coffee:20')}if(!((aP=(aQ))===~~aP&&(0)<=aP)){throw Error('"assert isInt n, 0" at src/helpers.coffee:21')}if(!aQ){return aO.slice(0,0)}aN=aQ*aO.length;while(aO.length*2<aN){aO=aO.concat(aO)}return aO.concat(aO.slice(0,aN-aO.length))};al=function(aN,aP){var aO;for(aO in aP){aN[aO]=aP[aO]}return aN};if(this.Uint8Array==null){this.Uint8Array=Array}if(this.Uint16Array==null){this.Uint16Array=Array}if(this.Uint32Array==null){this.Uint32Array=Array}if(this.Int8Array==null){this.Int8Array=Array}if(this.Int16Array==null){this.Int16Array=Array}if(this.Int32Array==null){this.Int32Array=Array}if((S=Array.prototype).set==null){S.set=function(aN,aR){var aO,aQ,aP;for(aO=aQ=0,aP=aN.length;aQ<aP;aO=aQ+=1){this[aR+aO]=aN[aO]}}}d=function(aQ,aO){var aR,aN,aS,aP;if(!(aQ.length!=null)){throw Error('"assert a.length?" at src/helpers.coffee:72')}if(!(aO.length!=null)){throw Error('"assert b.length?" at src/helpers.coffee:73')}if(aQ.length!==aO.length){return false}for(aR=aS=0,aP=aQ.length;aS<aP;aR=++aS){aN=aQ[aR];if(aN!==aO[aR]){return false}}return true};g=function(aO){var aN,aR,aQ,aP;if(aO instanceof Array){return aO.slice(0).reverse()}else{aN=new aO.constructor(aO.length);aN.set(aO);aQ=-1;aP=aO.length;while(++aQ<--aP){aR=aN[aQ];aN[aQ]=aN[aP];aN[aP]=aR}return aN}};aG=function(aP,aZ,aN){var aW,aO,aQ,aV,aR,aS,aY,aT,aX,aU;if(aZ==null){aZ=""}if(!(typeof aP==="string")){throw Error("\"assert typeof name is 'string'\" at src/errors.coffee:2")}if(!(typeof aZ==="string")){throw Error("\"assert typeof message is 'string'\" at src/errors.coffee:3")}if(aN!=null){aO=aN.aplCode,aT=aN.offset,aR=aN.file;if((aO!=null)&&(aT!=null)){if(!(typeof aO==="string")){throw Error("\"assert typeof aplCode is 'string'\" at src/errors.coffee:7")}if(!(typeof aT==="number")){throw Error("\"assert typeof offset is 'number'\" at src/errors.coffee:8")}if(!((aU=typeof aR)==="string"||aU==="undefined")){throw Error("\"assert typeof file in ['string', 'undefined']\" at src/errors.coffee:9")}aW=aO.slice(0,aT).split("\n");aY=aW.length;aQ=1+(aW[aW.length-1]||"").length;aZ+="\n"+(aR||"-")+":"+aY+":"+aQ+"\n"+(aO.split("\n")[aY-1])+"\n"+(u("_",aQ-1))+"^"}}aV=Error(aZ);aV.name=aP;for(aS in aN){aX=aN[aS];aV[aS]=aX}throw aV};L=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["SYNTAX ERROR"].concat(r.call(aN)))};aq=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["DOMAIN ERROR"].concat(r.call(aN)))};e=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["LENGTH ERROR"].concat(r.call(aN)))};ai=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["RANK ERROR"].concat(r.call(aN)))};C=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["INDEX ERROR"].concat(r.call(aN)))};P=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["NONCE ERROR"].concat(r.call(aN)))};aK=function(){var aN;aN=1<=arguments.length?r.call(arguments,0):[];return aG.apply(null,["VALUE ERROR"].concat(r.call(aN)))};av=(function(){function aN(a0,a2,aO,aY){var a1,aW,aT,aR,a4,aX,aV,a3,aP,aZ,aU,aS,aQ;this.data=a0;this.shape=a2;this.stride=aO;this.offset=aY!=null?aY:0;if(this.shape==null){this.shape=[this.data.length]}if(this.stride==null){this.stride=aa(this.shape)}if(!(this.data.length!=null)){throw Error('"assert @data.length?" at src/array.coffee:97')}if(!(this.shape.length!=null)){throw Error('"assert @shape.length?" at src/array.coffee:98')}if(!(this.stride.length!=null)){throw Error('"assert @stride.length?" at src/array.coffee:99')}if(!(this.data.length===0||((aW=this.offset)===~~aW&&((0)<=(aZ=aW)&&aZ<this.data.length)))){throw Error('"assert @data.length is 0 or isInt @offset, 0, @data.length" at src/array.coffee:100')}if(!(this.stride.length===this.shape.length)){throw Error('"assert @stride.length is ⍴⍴ @" at src/array.coffee:101')}aU=this.shape;for(aX=0,a3=aU.length;aX<a3;aX++){a4=aU[aX];if(!((aT=(a4))===~~aT&&(0)<=aT)){throw Error('"for x in @shape then assert isInt x, 0" at src/array.coffee:102')}}if(this.data.length){aS=this.stride;for(a1=aV=0,aP=aS.length;aV<aP;a1=++aV){a4=aS[a1];if(!((aR=(a4))===~~aR&&((-this.data.length)<=(aQ=aR)&&aQ<(this.data.length+1)))){throw Error('"for x, i in @stride then assert isInt x, -@data.length, @data.length + 1" at src/array.coffee:104')}}}}aN.prototype.empty=function(){var aR,aQ,aO,aP;aP=this.shape;for(aQ=0,aO=aP.length;aQ<aO;aQ++){aR=aP[aQ];if(!aR){return true}}return false};aN.prototype.map=function(aW){var aV,aY,aO,aU,aT,aS,aR,aQ,aP,aX;if(!(typeof aW==="function")){throw Error("\"assert typeof f is 'function'\" at src/array.coffee:111")}aV=[];aU=this;if(!aU.empty()){aS=aU.data;aR=aU.shape;aQ=aU.stride;aP=aR.length-1;aO=aU.offset;aY=[];aT=aR.length;while(--aT>=0){aY.push(0)}while(true){aX=aS[aO];aV.push(aW(aX,aY));aT=aP;while(aT>=0&&aY[aT]+1===aR[aT]){aO-=aY[aT]*aQ[aT];aY[aT--]=0}if(aT<0){break}aY[aT]++;aO+=aQ[aT]}}return new aN(aV,this.shape)};aN.prototype.map2=function(a4,a3){var a5,aR,a2,a1,a0,aZ,aY,aX,aW,aV,aU,aQ,aP,aO,aT,aS;if(!(a4 instanceof aN)){throw Error('"assert a instanceof APLArray" at src/array.coffee:117')}if(!(typeof a3==="function")){throw Error("\"assert typeof f is 'function'\" at src/array.coffee:118")}a5=[];a2=this;aX=a2.data;aV=a2.shape;aQ=a2.stride;a1=a4;aW=a1.data;aU=a1.shape;aP=a1.stride;if(aV.length!==aU.length){ai()}aY=aV.length;while(--aY>=0){if(aV[aY]!==aU[aY]){e()}}if(!a2.empty()){aO=aV.length-1;a0=a2.offset;aZ=a1.offset;aR=Array((aY=aV.length));while(--aY>=0){aR[aY]=0}while(true){aT=aX[a0];aS=aW[aZ];a5.push(a3(aT,aS,aR));aY=aO;while(aY>=0&&aR[aY]+1===aV[aY]){a0-=aR[aY]*aQ[aY];aZ-=aR[aY]*aP[aY];aR[aY--]=0}if(aY<0){break}aR[aY]++;a0+=aQ[aY];aZ+=aP[aY]}}return new aN(a5,this.shape)};aN.prototype.toArray=function(){var aO,aW,aV,aU,aT,aS,aR,aP,aQ,aX;aO=[];aW=this;if(!aW.empty()){aU=aW.data;aT=aW.shape;aS=aW.stride;aR=aT.length-1;aQ=aW.offset;aP=[];aV=aT.length;while(--aV>=0){aP.push(0)}while(true){aX=aU[aQ];aO.push(aX);aV=aR;while(aV>=0&&aP[aV]+1===aT[aV]){aQ-=aP[aV]*aS[aV];aP[aV--]=0}if(aV<0){break}aP[aV]++;aQ+=aS[aV]}}return aO};aN.prototype.toInt=function(aQ,aO){var aP;if(aQ==null){aQ=-Infinity}if(aO==null){aO=Infinity}aP=this.unwrap();if(typeof aP!=="number"||aP!==~~aP||!((aQ<=aP&&aP<aO))){return aq()}else{return aP}};aN.prototype.toBool=function(){return this.toInt(0,2)};aN.prototype.toSimpleString=function(){var aQ,aO,aR,aP;if(this.shape.length>1){ai()}if(typeof this.data==="string"){if(!this.shape.length){return this.data[this.offset]}if(this.shape[0]===0){return""}if(this.stride[0]===1){return this.data.slice(this.offset,this.offset+this.shape[0])}return this.toArray().join("")}else{aQ=this.toArray();for(aR=0,aP=aQ.length;aR<aP;aR++){aO=aQ[aR];if(typeof aO!=="string"){aq()}}return aQ.join("")}};aN.prototype.isSingleton=function(){var aR,aQ,aO,aP;aP=this.shape;for(aQ=0,aO=aP.length;aQ<aO;aQ++){aR=aP[aQ];if(aR!==1){return false}}return true};aN.prototype.isSimple=function(){return this.shape.length===0&&!(this.data[this.offset] instanceof aN)};aN.prototype.unwrap=function(){if(aC(this.shape)===1){return this.data[this.offset]}else{return e()}};aN.prototype.getPrototype=function(){if(this.empty()||typeof this.data[this.offset]!=="string"){return 0}else{return" "}};aN.prototype.toString=function(){return x(this).join("\n")};aN.prototype.repr=function(){return"new APLArray("+(f(this.data))+","+(f(this.shape))+","+(f(this.stride))+","+(f(this.offset))+")"};return aN})();aa=function(aN){var aO,aQ,aP,aS,aR;if(!(aN.length!=null)){throw Error('"assert shape.length?" at src/array.coffee:157')}if(aN.length===0){return[]}aQ=Array(aN.length);aQ[aQ.length-1]=1;for(aO=aS=aR=aQ.length-2;aS>=0;aO=aS+=-1){if(!((aP=aN[aO])===~~aP&&(0)<=aP)){throw Error('"assert isInt shape[i], 0" at src/array.coffee:162')}aQ[aO]=aQ[aO+1]*aN[aO+1]}return aQ};av.zero=new av([0],[]);av.one=new av([1],[]);av.zilde=new av([],[0]);av.scalar=function(aN){return new av([aN],[])};av.bool=[av.zero,av.one];ax=function(aN){if(typeof aN==="number"){return new K(aN,0)}else{if(aN instanceof K){return aN}else{return aq()}}};t=function(aO,aN){if(aN!==0){return new K(aO,aN)}else{return aO}};K=(function(){var a2,a5,aZ,aT,aO,a9,a4,aW,aX,a8,a3,aS,aU,aV,a0,aP,a1,aR,aN,aY,ba,a6,aQ;function a7(bc,bb){this.re=bc;this.im=bb!=null?bb:0;if(!(typeof this.re==="number")){throw Error("\"assert typeof @re is 'number'\" at src/complex.coffee:20")}if(!(typeof this.im==="number")){throw Error("\"assert typeof @im is 'number'\" at src/complex.coffee:21")}if(isNaN(this.re)||isNaN(this.im)){aq("NaN")}}a7.prototype.toString=function(){return""+((""+this.re).replace("Infinity","∞").replace(/-/g,"¯"))+"J"+((""+this.im).replace("Infinity","∞").replace(/-/g,"¯"))};a7.prototype.repr=function(){return"new Complex("+(f(this.re))+","+(f(this.im))+")"};a7.exp=aW=function(bb){var bc;bb=ax(bb);bc=Math.exp(bb.re);return t(bc*Math.cos(bb.im),bc*Math.sin(bb.im))};a7.log=aV=function(bb){if(typeof bb==="number"&&bb>0){return Math.log(bb)}else{bb=ax(bb);return t(Math.log(Math.sqrt(bb.re*bb.re+bb.im*bb.im)),a9(bb))}};a7.conjugate=function(bb){return new a7(bb.re,-bb.im)};a7.negate=aP=function(bb){return new a7(-bb.re,-bb.im)};a7.itimes=aU=function(bb){bb=ax(bb);return t(-bb.im,bb.re)};a7.negitimes=a1=function(bb){bb=ax(bb);return t(bb.im,-bb.re)};a7.add=a5=function(bb,bc){bb=ax(bb);bc=ax(bc);return t(bb.re+bc.re,bb.im+bc.im)};a7.subtract=a6=function(bb,bc){bb=ax(bb);bc=ax(bc);return t(bb.re-bc.re,bb.im-bc.im)};a7.multiply=a0=function(bb,bc){bb=ax(bb);bc=ax(bc);return t(bb.re*bc.re-bb.im*bc.im,bb.re*bc.im+bb.im*bc.re)};a7.divide=a4=function(bb,bd){var bc;bb=ax(bb);bd=ax(bd);bc=bd.re*bd.re+bd.im*bd.im;return t((bb.re*bd.re+bb.im*bd.im)/bc,(bd.re*bb.im-bd.im*bb.re)/bc)};a7.pow=aR=function(bb,bd){var bc;if((typeof bb===(bc=typeof bd)&&bc==="number")&&bb>=0){return Math.pow(bb,bd)}else{return aW(a0(bd,aV(bb)))}};a7.sqrt=ba=function(bb){if(typeof bb==="number"&&bb>=0){return Math.sqrt(bb)}else{return aR(bb,0.5)}};a7.magnitude=function(bb){return Math.sqrt(bb.re*bb.re+bb.im*bb.im)};a7.direction=a9=function(bb){return Math.atan2(bb.im,bb.re)};a7.sin=function(bb){return a1(aY(aU(bb)))};a7.cos=function(bb){return aO(aU(bb))};a7.tan=function(bb){return a1(aQ(aU(bb)))};a7.asin=aZ=function(bb){bb=ax(bb);return a1(aV(a5(aU(bb),ba(a6(1,aR(bb,2))))))};a7.acos=a2=function(bb){var bc;bb=ax(bb);bc=a1(aV(a5(bb,ba(a6(aR(bb,2),1)))));if(bc instanceof a7&&(bc.re<0||(bc.re===0&&bc.im<0))){return aP(bc)}else{return bc}};a7.atan=aT=function(bb){var bc;bb=ax(bb);bc=aU(bb);return a0(new a7(0,0.5),a6(aV(a6(1,bc)),aV(a5(1,bc))))};a7.sinh=aY=function(bb){var bc;bc=aW(bb);return a0(0.5,a6(bc,a4(1,bc)))};a7.cosh=aO=function(bb){var bc;bc=aW(bb);return a0(0.5,a5(bc,a4(1,bc)))};a7.tanh=aQ=function(bc){var bd,bb;bd=aW(bc);bb=a4(1,bd);return a4(a6(bd,bb),a5(bd,bb))};a7.asinh=function(bb){return aU(aZ(a1(bb)))};a7.acosh=function(bb){var bc;bb=ax(bb);bc=bb.im>0||(bb.im===0&&bb.re<=1)?1:-1;return a0(new a7(0,bc),a2(bb))};a7.atanh=function(bb){return aU(aT(a1(bb)))};a7.floor=a8=function(bc){var be,bd,bg,bf,bh,bb;if(typeof bc==="number"){return Math.floor(bc)}else{bc=ax(bc);bh=[Math.floor(bc.re),Math.floor(bc.im)],bf=bh[0],bd=bh[1];bb=[bc.re-bf,bc.im-bd],bg=bb[0],be=bb[1];if(bg+be>=1){if(bg>=be){bf++}else{bd++}}return t(bf,bd)}};a7.ceil=function(bc){var be,bd,bg,bf,bh,bb;if(typeof bc==="number"){return Math.ceil(bc)}else{bc=ax(bc);bh=[Math.ceil(bc.re),Math.ceil(bc.im)],bf=bh[0],bd=bh[1];bb=[bf-bc.re,bd-bc.im],bg=bb[0],be=bb[1];if(bg+be>=1){if(bg>=be){bf--}else{bd--}}return t(bf,bd)}};aS=function(bb){return bb===0||(bb instanceof a7&&bb.re===0&&bb.im===0)};a7.residue=aN=function(bb,bd){var bc;if((typeof bb===(bc=typeof bd)&&bc==="number")){if(bb===0){return bd}else{return bd-bb*Math.floor(bd/bb)}}else{if(aS(bb)){return bd}else{return a6(bd,a0(bb,a8(a4(bd,bb))))}}};a7.isint=function(bb){if(typeof bb==="number"){return bb===Math.floor(bb)}else{return(bb.re===Math.floor(bb.re))&&(bb.im===Math.floor(bb.im))}};aX=function(bb){if(typeof bb==="number"){return Math.abs(bb)}else{if(bb.re<0){bb=aP(bb)}if(bb.im<0){bb=aU(bb)}if(bb.re===0){bb=bb.im}return bb}};a7.gcd=a3=function(bc,bf){var bd,bb,be;if((typeof bc===(bd=typeof bf)&&bd==="number")){while(bf){bb=[bf,bc%bf],bc=bb[0],bf=bb[1]}return Math.abs(bc)}else{while(!aS(bf)){be=[bf,aN(bf,bc)],bc=be[0],bf=be[1]}return aX(bc)}};a7.lcm=function(bb,bd){var bc;bc=a0(bb,bd);if(aS(bc)){return bc}else{return a4(bc,a3(bb,bd))}};return a7})();aJ=[1,2,3,4,5,6,7,8,9,10,11,12],E=aJ[0],au=aJ[1],q=aJ[2],aw=aJ[3],M=aJ[4],j=aJ[5],ao=aJ[6],aA=aJ[7],H=aJ[8],b=aJ[9],h=aJ[10],aL=aJ[11];aM=(function(){function aN(aP,aQ,aO){this.code=aP;this.addr=aQ;this.env=aO}aN.prototype.toFunction=function(){return(function(aO){return function(aP,aQ){return J({code:aO.code,env:aO.env.concat([[aP,aO,aQ]]),pc:aO.addr})}})(this)};aN.prototype.toString=function(){return"λ"};return aN})();J=function(aX){var a5,aO,a3,a4,a0,a2,aN,a1,aW,aZ,aY,aT,aR,a6,a7,aV,aU,aS,aQ,aP;aO=aX.code,a3=aX.env,aW=aX.stack,aN=aX.pc;if(!(aO instanceof Array)){throw Error('"assert code instanceof Array" at src/vm.coffee:9')}if(!(a3 instanceof Array)){throw Error('"assert env instanceof Array" at src/vm.coffee:10')}for(aT=0,a6=a3.length;aT<a6;aT++){a0=a3[aT];if(!(a0 instanceof Array)){throw Error('"for frame in env then assert frame instanceof Array" at src/vm.coffee:11')}}if(aW==null){aW=[]}if(aN==null){aN=0}while(true){switch(aO[aN++]){case E:aW.push(aO[aN++]);break;case au:a5=[];aV=aW.splice(aW.length-aO[aN++]);for(aR=0,a7=aV.length;aR<a7;aR++){aY=aV[aR];a5.push(aY.isSimple()?aY.unwrap():aY)}aW.push(new av(a5));break;case q:aW.push((aU=a3[aO[aN++]][aO[aN++]])!=null?aU:aK());break;case aw:a3[aO[aN++]][aO[aN++]]=aW[aW.length-1];break;case M:aS=aW.splice(-2),aZ=aS[0],a4=aS[1];if(typeof a4==="function"){if(aZ instanceof aM){aZ=aZ.toFunction()}if(a4.cps){a4(aZ,void 0,void 0,function(a8){aW.push(a8);J({code:aO,env:a3,stack:aW,pc:aN})});return}else{aW.push(a4(aZ))}}else{aW.push(aO,aN,a3);aO=a4.code;aN=a4.addr;a3=a4.env.concat([[aZ,a4,null]])}break;case j:aQ=aW.splice(-3),aZ=aQ[0],a4=aQ[1],a5=aQ[2];if(typeof a4==="function"){if(aZ instanceof aM){aZ=aZ.toFunction()}if(a5 instanceof aM){a5=a5.toFunction()}if(a4.cps){a4(aZ,a5,void 0,function(a8){aW.push(a8);J({code:aO,env:a3,stack:aW,pc:aN})});return}else{aW.push(a4(aZ,a5))}}else{aW.push(aO,aN,a3);aO=a4.code;aN=a4.addr;a3=a4.env.concat([[aZ,a4,a5]])}break;case ao:a1=aO[aN++];aW.push(new aM(aO,aN,a3));aN+=a1;break;case aA:if(aW.length===1){return aW[0]}aP=aW.splice(-4,3),aO=aP[0],aN=aP[1],a3=aP[2];break;case H:aW.pop();break;case b:a2=aO[aN++];a5=aW[aW.length-1].toArray().reverse();a5=(function(){var ba,a8,a9;a9=[];for(ba=0,a8=a5.length;ba<a8;ba++){aY=a5[ba];a9.push(aY instanceof av?aY:new av([aY],[]))}return a9})();if(a5.length===1){a5=u(a5,a2)}else{if(a5.length!==a2){e()}}aW.push.apply(aW,a5);break;case h:a2=aO[aN++];if(!aW[aW.length-1].toBool()){aN+=a2}break;case aL:a0=a3[a3.length-1];aW.push(aO[aN++](a0[0],a0[2]));break;default:aG("Unrecognized instruction: "+aO[aN-1]+", pc:"+aN)}}};ac=[["-",/^(?:[ \t]+|[⍝\#].*)+/],["L",/^[\n\r]+/],["⋄",/^[◇⋄]/],["N",/^¯?(?:0x[\da-f]+|\d*\.?\d+(?:e[+¯]?\d+)?|¯|∞)(?:j¯?(?:0x[\da-f]+|\d*\.?\d+(?:e[+¯]?\d+)?|¯|∞))?/i],["S",/^(?:'[^']*')+|^(?:"[^"]*")+/],[".",/^[\(\)\[\]\{\}:;←]/],["J",/^«[^»]*»/],["X",/^(?:⎕?[a-z_]\w*|⍺⍺|⍵⍵|∇∇|[^¯'":«»])/i]];F=function(a0,aN){var aO,aU,aR,aY,aV,aZ,aT,aS,aX,aQ,aW,aP;if(aN==null){aN={}}aR=0;aV=["{"];aT=[];aU=a0.length;while(aR<aU){aS=null;for(aQ=0,aW=ac.length;aQ<aW;aQ++){aP=ac[aQ],aZ=aP[0],aY=aP[1];if(!(aO=a0.slice(aR).match(aY))){continue}aX=aO[0];aS=aZ==="."?aX:aZ;break}if(!aS){L("Unrecognized token",{file:aN.file,offset:aR,s:aN.s})}if(aS!=="-"){if(aF.call("([{",aS)>=0){aV.push(aS)}else{if(aF.call(")]}",aS)>=0){aV.pop()}}if(aS!=="L"||aV[aV.length-1]==="{"){aT.push({type:aS,value:aX,offset:aR,aplCode:a0})}}aR+=aX.length}aT.push({type:"$",value:"",offset:aR,aplCode:a0});return aT};an=function(aO,aN){var aR,aQ,aT,aS,aV,aP,aU;if(aN==null){aN={}}aU=F(aO);aR=0;aP=aU[aR++];aS=function(aW){return L(aW,{file:aN.file,offset:aP.offset,aplCode:aO})};aQ=function(){var aX,aZ,aW,a1,a0,aY;aX=["B"];while(true){if(aW=aP.type,aF.call("$};",aW)>=0){return aX}while(((a1=aP.type)==="⋄"||a1==="L"?aP=aU[aR++]:void 0)){}if(a0=aP.type,aF.call("$};",a0)>=0){return aX}aZ=aT();if(((aY=aP.type)===":"?aP=aU[aR++]:void 0)){aZ=[":",aZ,aT()]}aX.push(aZ)}};aT=function(){var a4,a5,a6,a3,a2,a1,a0,aZ,aY,aX,aW,a7;a4=["."];while(true){a6=aP;if(((a3=aP.type)==="N"||a3==="S"||a3==="X"||a3==="J"?aP=aU[aR++]:void 0)){a5=[a6.type,a6.value]}else{if(((a2=aP.type)==="("?aP=aU[aR++]:void 0)){if(((a1=aP.type)===")"?aP=aU[aR++]:void 0)){a5=["⍬"]}else{a5=aT();if(aP.type===")"){aP=aU[aR++]}else{aS("Expected token of type ')' but got '"+aP.type+"'")}}}else{if(((a0=aP.type)==="{"?aP=aU[aR++]:void 0)){a5=["{",aQ()];while(((aZ=aP.type)===";"?aP=aU[aR++]:void 0)){a5.push(aQ())}if(aP.type==="}"){aP=aU[aR++]}else{aS("Expected token of type '}' but got '"+aP.type+"'")}}else{aS("Encountered unexpected token of type '"+aP.type+"'")}}}if(((aY=aP.type)==="["?aP=aU[aR++]:void 0)){a5=["[",a5];while(true){if(((aX=aP.type)===";"?aP=aU[aR++]:void 0)){a5.push(null)}else{if(aP.type==="]"){a5.push(null);break}else{a5.push(aT());if(aP.type==="]"){break}else{if(aP.type===";"){aP=aU[aR++]}else{aS("Expected token of type ';' but got '"+aP.type+"'")}}}}}if(aP.type==="]"){aP=aU[aR++]}else{aS("Expected token of type ']' but got '"+aP.type+"'")}}if(((aW=aP.type)==="←"?aP=aU[aR++]:void 0)){return a4.concat([["←",a5,aT()]])}a4.push(a5);if(a7=aP.type,aF.call(")]}:;⋄L$",a7)>=0){return a4}}};aV=aQ();if(aP.type==="$"){aP=aU[aR++]}else{aS("Expected token of type '$' but got '"+aP.type+"'")}return aV};B={};aB=function(aP){var aO,aN;for(aO in aP){aN=aP[aO];B[aO]=aN}};V=function(aP){var aQ,aR,aO,aN;aR=aP.monad,aQ=aP.dyad;aN=aR?function(aS){var aT;if(aS instanceof av){return aS.map(aN)}else{aT=aR(aS);if(typeof aT==="number"&&isNaN(aT)){aq("NaN")}return aT}}:P;aO=aQ?function(a1,a0){var aT,aS,aY,aX,aZ,aV,aW,aU;aY=a1 instanceof av?(a1.isSingleton()?1:2):0;aX=a0 instanceof av?(a0.isSingleton()?1:2):0;switch(16*aY+aX){case 0:aS=aQ(a1,a0);if(typeof aS==="number"&&isNaN(aS)){aq("NaN")}return aS;case 1:case 2:return a0.map(function(a2){return aO(a1,a2)});case 16:case 32:return a1.map(function(a2){return aO(a2,a0)});case 18:aZ=a1.data[a1.offset];return a0.map(function(a2){return aO(aZ,a2)});case 33:case 17:aV=a0.data[a0.offset];return a1.map(function(a2){return aO(a2,aV)});case 34:if(a1.shape.length!==a0.shape.length){ai()}for(aT=aW=0,aU=a1.shape.length;aW<aU;aT=aW+=1){if(a1.shape[aT]!==a0.shape[aT]){e()}}return a1.map2(a0,aO);default:if(!(0)){throw Error('"else assert 0" at src/vocabulary/vhelpers.coffee:40')}}}:P;return function(aT,aS){if(!(aT instanceof av)){throw Error('"assert ⍵ instanceof APLArray" at src/vocabulary/vhelpers.coffee:44')}if(!(aS instanceof av||(aS==null))){throw Error('"assert ⍺ instanceof APLArray or !⍺?" at src/vocabulary/vhelpers.coffee:45')}return(aS!=null?aO:aN)(aT,aS)}};ag=function(aO,aN){return function(aP,aR,aQ){if(typeof aP==="number"&&((aR==null)||typeof aR==="number")){return aO(aP,aR,aQ)}else{aP=ax(aP);if(aR!=null){aR=ax(aR)}return aN(aP,aR,aQ)}}};at=function(aX,aV){var aO,a0,aZ,aY,aW,aU,aT,aS,aR,aQ,a6,a5,a4,a3,a2,a1,a7,aN,aP;if(aX instanceof av){if(!(aV instanceof av)){return false}else{if(aX.shape.length!==aV.shape.length){return false}for(aO=aN=0,aP=aX.shape.length;aN<aP;aO=aN+=1){if(aX.shape[aO]!==aV.shape[aO]){return false}}a0=true;aZ=aX;aS=aZ.data;aQ=aZ.shape;a5=aZ.stride;aY=aV;aR=aY.data;a6=aY.shape;a4=aY.stride;if(aQ.length!==a6.length){ai()}aT=aQ.length;while(--aT>=0){if(aQ[aT]!==a6[aT]){e()}}if(!aZ.empty()){a3=aQ.length-1;aW=aZ.offset;aU=aY.offset;a2=Array((aT=aQ.length));while(--aT>=0){a2[aT]=0}while(true){a1=aS[aW];a7=aR[aU];if(!at(a1,a7)){a0=false}aT=a3;while(aT>=0&&a2[aT]+1===aQ[aT]){aW-=a2[aT]*a5[aT];aU-=a2[aT]*a4[aT];a2[aT--]=0}if(aT<0){break}a2[aT]++;aW+=a5[aT];aU+=a4[aT]}}return a0}}else{if(aV instanceof av){return false}else{if(aX instanceof K&&aV instanceof K){return aX.re===aV.re&&aX.im===aV.im}else{return aX===aV}}}};X=function(aN,aO){return aN===aO||Math.abs(aN-aO)<1e-11};ar=function(aZ,aY){var aT,a0,a6,a5,a4,a3,a2,aX,aW,aV,aS,aR,aP,aO,aN,a1,a7,aQ,aU;if(aZ instanceof av){if(!(aY instanceof av)){return false}else{if(aZ.shape.length!==aY.shape.length){return false}for(aT=aQ=0,aU=aZ.shape.length;aQ<aU;aT=aQ+=1){if(aZ.shape[aT]!==aY.shape[aT]){return false}}a0=true;a6=aZ;aX=a6.data;aV=a6.shape;aR=a6.stride;a5=aY;aW=a5.data;aS=a5.shape;aP=a5.stride;if(aV.length!==aS.length){ai()}a2=aV.length;while(--a2>=0){if(aV[a2]!==aS[a2]){e()}}if(!a6.empty()){aO=aV.length-1;a4=a6.offset;a3=a5.offset;aN=Array((a2=aV.length));while(--a2>=0){aN[a2]=0}while(true){a1=aX[a4];a7=aW[a3];if(!ar(a1,a7)){a0=false}a2=aO;while(a2>=0&&aN[a2]+1===aV[a2]){a4-=aN[a2]*aR[a2];a3-=aN[a2]*aP[a2];aN[a2--]=0}if(a2<0){break}aN[a2]++;a4+=aR[a2];a3+=aP[a2]}}return a0}}else{if(aY instanceof av){return false}else{if(!((aZ!=null)&&(aY!=null))){return false}else{if(typeof aZ==="number"){aZ=new K(aZ)}if(typeof aY==="number"){aY=new K(aY)}if(aZ instanceof K){return aY instanceof K&&X(aZ.re,aY.re)&&X(aZ.im,aY.im)}else{return aZ===aY}}}}};ab=function(aN){if(aN!==0&&aN!==1){return aq()}else{return aN}};af=function(aS,aQ){var aU,aR,aX,aW,aY,aV,aP,aT,aO,aN;if(!((aX=(aQ))===~~aX&&(0)<=aX)){throw Error('"assert isInt rank, 0" at src/vocabulary/vhelpers.coffee:118')}if(aS==null){return[]}if(!(aS instanceof av)){throw Error('"assert axes instanceof APLArray" at src/vocabulary/vhelpers.coffee:120')}if(aS.shape.length!==1||aS.shape[0]!==1){L()}aU=aS.unwrap();if(aU instanceof av){aU=aU.toArray();for(aR=aP=0,aT=aU.length;aP<aT;aR=++aP){aV=aU[aR];if(!((aW=(aV))===~~aW&&((0)<=(aO=aW)&&aO<(aQ)))){aq()}if(aF.call(aU.slice(0,aR),aV)>=0){aq("Non-unique axes")}}return aU}else{if((aY=(aU))===~~aY&&((0)<=(aN=aY)&&aN<(aQ))){return[aU]}else{return aq()}}};Z=function(aN,aO){aO.identity=aN instanceof av?aN:av.scalar(aN);return aO};v=function(aN){aN.isAdverb=true;return aN};ah=function(aN){aN.isConjunction=true;return aN};p=function(aN){aN.cps=true;return aN};aB({"+":Z(0,V({monad:ag((function(aN){return aN}),K.conjugate),dyad:ag((function(aO,aN){return aN+aO}),function(aO,aN){return K.add(aN,aO)})})),"-":Z(0,V({monad:ag((function(aN){return -aN}),K.negate),dyad:ag((function(aO,aN){return aN-aO}),function(aO,aN){return K.subtract(aN,aO)})})),"×":Z(1,V({monad:ag((function(aN){return(aN>0)-(aN<0)}),function(aN){var aO;aO=Math.sqrt(aN.re*aN.re+aN.im*aN.im);return t(aN.re/aO,aN.im/aO)}),dyad:ag((function(aO,aN){return aN*aO}),function(aO,aN){return K.multiply(aN,aO)})})),"÷":Z(1,V({monad:ag((function(aN){return 1/aN}),function(aN){var aO;aO=aN.re*aN.re+aN.im*aN.im;return t(aN.re/aO,-aN.im/aO)}),dyad:ag((function(aO,aN){return aN/aO}),function(aO,aN){return K.divide(aN,aO)})})),"*":Z(1,V({monad:ay=ag(Math.exp,K.exp),dyad:function(aO,aN){return K.pow(aN,aO)}})),"⍟":V({monad:K.log,dyad:function(aP,aO){var aN;if((typeof aO===(aN=typeof aP)&&aN==="number")&&aO>0&&aP>0){return Math.log(aP)/Math.log(aO)}else{return K.divide(K.log(aP),K.log(aO))}}}),"|":Z(0,V({monad:ag((function(aN){return Math.abs(aN)}),K.magnitude),dyad:function(aO,aN){return K.residue(aN,aO)}}))});aB({"\\":v(function(aP,aO,aN){if(typeof aP==="function"){return aj(aP,void 0,aN)}else{return am(aP,aO,aN)}}),"⍀":v(function(aP,aO,aN){if(aN==null){aN=av.zero}if(typeof aP==="function"){return aj(aP,void 0,aN)}else{return am(aP,aO,aN)}})});aj=function(aP,aO,aN){if(!(typeof aO==="undefined")){throw Error("\"assert typeof g is 'undefined'\" at src/vocabulary/backslash.coffee:44")}return function(aR,aQ){if(!(aQ==null)){throw Error('"assert !⍺?" at src/vocabulary/backslash.coffee:46')}if(!aR.shape.length){return aR}aN=aN?aN.toInt(0,aR.shape.length):aR.shape.length-1;return aR.map(function(a1,a2){var a0,aX,aW,aS,aY,aV,aU,aZ,aT;aS=aR.offset;for(a0=aV=0,aZ=a2.length;aV<aZ;a0=++aV){aX=a2[a0];aS+=aX*aR.stride[a0]}if(!(a1 instanceof av)){a1=av.scalar(a1)}for(aW=aU=0,aT=a2[aN];aU<aT;aW=aU+=1){aS-=aR.stride[aN];aY=aR.data[aS];if(!(aY instanceof av)){aY=av.scalar(aY)}a1=aP(a1,aY)}if(!a1.shape.length){a1=a1.unwrap()}return a1})}};am=function(a0,aQ,aO){var aZ,aW,aT,aS,aU,a2,aN,aV,a1,aY,aR,aX,aP;if(!a0.shape.length){P("Expand of scalar not implemented")}aO=aO?aO.toInt(0,a0.shape.length):a0.shape.length-1;if(aQ.shape.length>1){ai()}aZ=aQ.toArray();aV=a0.shape.slice(0);aV[aO]=aZ.length;aW=[];aU=0;for(aR=0,aX=aZ.length;aR<aX;aR++){aY=aZ[aR];if(!((a1=(aY))===~~a1&&((0)<=(aP=a1)&&aP<(2)))){aq()}aW.push(aY>0?aU++:null)}if(aU!==a0.shape[aO]){e()}aT=[];if(aV[aO]!==0&&!a0.empty()){aS=a0.getPrototype();aN=a0.offset;a2=u([0],aV.length);while(true){aY=aW[a2[aO]]!=null?a0.data[aN+aW[a2[aO]]*a0.stride[aO]]:aS;aT.push(aY);aU=aV.length-1;while(aU>=0&&a2[aU]+1===aV[aU]){if(aU!==aO){aN-=a0.stride[aU]*a2[aU]}a2[aU--]=0}if(aU<0){break}if(aU!==aO){aN+=a0.stride[aU]}a2[aU]++}}return new av(aT,aV)};aB({"○":V({monad:ag((function(aN){return Math.PI*aN}),function(aN){return new K(Math.PI*aN.re,Math.PI*aN.im)}),dyad:function(aO,aR){var aP,aN,aQ;if(typeof aO==="number"){switch(aR){case -12:return K.exp(t(0,aO));case -11:return t(0,aO);case -10:return aO;case -9:return aO;case -8:return t(0,-Math.sqrt(1+aO*aO));case -7:return K.atanh(aO);case -6:return K.acosh(aO);case -5:return K.asinh(aO);case -4:aQ=K.sqrt(aO*aO-1);if(aO<-1){return -aQ}else{return aQ}break;case -3:return K.atan(aO);case -2:return K.acos(aO);case -1:return K.asin(aO);case 0:return K.sqrt(1-aO*aO);case 1:return Math.sin(aO);case 2:return Math.cos(aO);case 3:return Math.tan(aO);case 4:return Math.sqrt(1+aO*aO);case 5:aP=Math.exp(aO);aN=1/aP;return 0.5*(aP-aN);case 6:aP=Math.exp(aO);aN=1/aP;return 0.5*(aP+aN);case 7:aP=Math.exp(aO);aN=1/aP;return(aP-aN)/(aP+aN);case 8:return K.sqrt(-1-aO*aO);case 9:return aO;case 10:return Math.abs(aO);case 11:return 0;case 12:return 0;default:return aq("Unknown circular or hyperbolic function "+aR)}}else{if(aO instanceof K){switch(aR){case -12:return K.exp(t(-aO.im,aO.re));case -11:return K.itimes(aO);case -10:return K.conjugate(aO);case -9:return aO;case -8:aQ=K.subtract(-1,K.multiply(aO,aO));return K.negate(K.sqrt(aQ));case -7:return K.atanh(aO);case -6:return K.acosh(aO);case -5:return K.asinh(aO);case -4:if(aO.re===-1&&aO.im===0){return 0}else{aP=K.add(aO,1);aN=K.subtract(aO,1);return K.multiply(aP,K.sqrt(K.divide(aN,aP)))}break;case -3:return K.atan(aO);case -2:return K.acos(aO);case -1:return K.asin(aO);case 0:return K.sqrt(K.subtract(1,K.multiply(aO,aO)));case 1:return K.sin(aO);case 2:return K.cos(aO);case 3:return K.tan(aO);case 4:return K.sqrt(K.add(1,K.multiply(aO,aO)));case 5:return K.sinh(aO);case 6:return K.cosh(aO);case 7:return K.tanh(aO);case 8:return K.sqrt(K.subtract(-1,K.multiply(aO,aO)));case 9:return aO.re;case 10:return K.magnitude(aO);case 11:return aO.im;case 12:return K.direction(aO);default:return aq("Unknown circular or hyperbolic function "+aR)}}else{return aq()}}}})});aB({",":function(a2,aY,aW){var a9,bc,a7,a8,a4,aZ,a3,a1,a6,a0,aS,a5,aR,aP,aO,aN,bd,bb,ba,aU,aQ,aX,aV,aT;if(aY){a8=Math.max(aY.shape.length,a2.shape.length);if(aW){aW=aW.unwrap();if(typeof aW!=="number"){aq()}if(a8&&!((0<=aW&&aW<a8))){ai()}}else{aW=a8-1}if((aY.shape.length===(aX=a2.shape.length)&&aX===0)){return new av([aY.unwrap(),a2.unwrap()])}else{if(!aY.shape.length){a0=a2.shape.slice(0);if((aR=(aW))===~~aR){a0[aW]=1}aY=new av([aY.unwrap()],a0,u([0],a2.shape.length))}else{if(!a2.shape.length){a0=aY.shape.slice(0);if((aP=(aW))===~~aP){a0[aW]=1}a2=new av([a2.unwrap()],a0,u([0],aY.shape.length))}else{if(aY.shape.length+1===a2.shape.length){if(!((aO=(aW))===~~aO)){ai()}aS=aY.shape.slice(0);aS.splice(aW,0,1);a5=aY.stride.slice(0);a5.splice(aW,0,0);aY=new av(aY.data,aS,a5,aY.offset)}else{if(aY.shape.length===a2.shape.length+1){if(!((aN=(aW))===~~aN)){ai()}aS=a2.shape.slice(0);aS.splice(aW,0,1);a5=a2.stride.slice(0);a5.splice(aW,0,0);a2=new av(a2.data,aS,a5,a2.offset)}else{if(aY.shape.length!==a2.shape.length){ai()}}}}}}if(!(aY.shape.length===a2.shape.length)){throw Error('"assert ⍴⍴(⍺) is ⍴⍴(⍵)" at src/vocabulary/comma.coffee:59')}for(a7=aU=0,aV=aY.shape.length;0<=aV?aU<aV:aU>aV;a7=0<=aV?++aU:--aU){if(a7!==aW&&aY.shape[a7]!==a2.shape[a7]){e()}}aS=aY.shape.slice(0);if((bd=(aW))===~~bd){aS[aW]+=a2.shape[aW]}else{aS.splice(Math.ceil(aW),0,2)}bc=Array(aC(aS));a5=Array(aS.length);a5[aS.length-1]=1;for(a7=aQ=aT=aS.length-2;aQ>=0;a7=aQ+=-1){a5[a7]=a5[a7+1]*aS[a7+1]}if((bb=(aW))===~~bb){a6=a5}else{a6=a5.slice(0);a6.splice(Math.ceil(aW),1)}if(!aY.empty()){a1=0;a4=aY.offset;aZ=u([0],aY.shape.length);while(true){bc[a1]=aY.data[a4];a9=aZ.length-1;while(a9>=0&&aZ[a9]+1===aY.shape[a9]){a4-=aZ[a9]*aY.stride[a9];a1-=aZ[a9]*a6[a9];aZ[a9--]=0}if(a9<0){break}a4+=aY.stride[a9];a1+=a6[a9];aZ[a9]++}}if(!a2.empty()){a1=(ba=(aW))===~~ba?a5[aW]*aY.shape[aW]:a5[Math.ceil(aW)];a3=a2.offset;aZ=u([0],a2.shape.length);while(true){bc[a1]=a2.data[a3];a9=aZ.length-1;while(a9>=0&&aZ[a9]+1===a2.shape[a9]){a3-=aZ[a9]*a2.stride[a9];a1-=aZ[a9]*a6[a9];aZ[a9--]=0}if(a9<0){break}a3+=a2.stride[a9];a1+=a6[a9];aZ[a9]++}}return new av(bc,aS,a5)}else{if(!(0)){throw Error('"assert 0" at src/vocabulary/comma.coffee:120')}}}});aB({"=":Z(1,V({dyad:c=function(aO,aN){if(aN instanceof K&&aO instanceof K){return +(aN.re===aO.re&&aN.im===aO.im)}else{return +(aN===aO)}}})),"≠":Z(0,V({dyad:function(aO,aN){return 1-c(aO,aN)}})),"<":Z(0,V({dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return +(aN<aP)}else{return aq()}}})),">":Z(0,V({dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return +(aN>aP)}else{return aq()}}})),"≤":Z(1,V({dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return +(aN<=aP)}else{return aq()}}})),"≥":Z(1,V({dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return +(aN>=aP)}else{return aq()}}})),"≡":function(aO,aN){if(aN){return av.bool[+at(aO,aN)]}else{return new av([G(aO)],[])}}});G=function(aV){var aN,aX,aW,aU,aT,aR,aQ,aO,aP,aS;if(aV instanceof av){if((!aV.shape.length)&&(!(aV.data[0] instanceof av))){return 0}aN=0;aX=aV;if(!aX.empty()){aU=aX.data;aT=aX.shape;aR=aX.stride;aQ=aT.length-1;aP=aX.offset;aO=[];aW=aT.length;while(--aW>=0){aO.push(0)}while(true){aS=aU[aP];aN=Math.max(aN,G(aS));aW=aQ;while(aW>=0&&aO[aW]+1===aT[aW]){aP-=aO[aW]*aR[aW];aO[aW--]=0}if(aW<0){break}aO[aW]++;aP+=aR[aW]}}return aN+1}else{return 0}};aB({"∘":ah(function(aN,aO){if(typeof aO==="function"){if(typeof aN==="function"){return function(aQ,aP){return aO(aN(aQ),aP)}}else{return function(aQ,aP){if(!(aP==null)){throw Error('"assert !⍺?" at src/vocabulary/compose.coffee:20')}return aO(aN,aQ)}}}else{if(!(typeof aN==="function")){throw Error("\"assert typeof g is 'function'\" at src/vocabulary/compose.coffee:23")}return function(aQ,aP){if(!(aP==null)){throw Error('"assert !⍺?" at src/vocabulary/compose.coffee:25')}return aN(aQ,aO)}}})});aB({"∪":function(a7,aY){var a9,ba,aX,aW,aV,aT,aS,aQ,aP,aO,aN,a6,a5,a4,a3,a2,a1,aZ,a0,aR,a8,aU;if(aY){ba=[];aU=[aY,a7];for(aR=0,a8=aU.length;aR<a8;aR++){a9=aU[aR];if(a9.shape.length>1){ai()}aX=a9;if(!aX.empty()){aV=aX.data;aT=aX.shape;aS=aX.stride;aQ=aT.length-1;aO=aX.offset;aP=[];aW=aT.length;while(--aW>=0){aP.push(0)}while(true){a0=aV[aO];if(!ae(ba,a0)){ba.push(a0)}aW=aQ;while(aW>=0&&aP[aW]+1===aT[aW]){aO-=aP[aW]*aS[aW];aP[aW--]=0}if(aW<0){break}aP[aW]++;aO+=aS[aW]}}}return new av(ba)}else{ba=[];aN=a7;if(!aN.empty()){a5=aN.data;a4=aN.shape;a3=aN.stride;a2=a4.length-1;aZ=aN.offset;a1=[];a6=a4.length;while(--a6>=0){a1.push(0)}while(true){a0=a5[aZ];if(!ae(ba,a0)){ba.push(a0)}a6=a2;while(a6>=0&&a1[a6]+1===a4[a6]){aZ-=a1[a6]*a3[a6];a1[a6--]=0}if(a6<0){break}a1[a6]++;aZ+=a3[a6]}}return new av(ba)}},"∩":function(aU,aT){var aP,aS,aO,aR,aQ,aN;if(aT){aS=[];aP=aU.toArray();aN=aT.toArray();for(aR=0,aQ=aN.length;aR<aQ;aR++){aO=aN[aR];if(ae(aP,aO)){aS.push(aO)}}return new av(aS)}else{return P()}}});ae=function(aP,aN){var aR,aQ,aO;if(!(aP.length!=null)){throw Error('"assert a.length?" at src/vocabulary/cupcap.coffee:56')}for(aQ=0,aO=aP.length;aQ<aO;aQ++){aR=aP[aQ];if(at(aN,aR)){return true}}return false};aB({"⊥":function(aY,aT){var a4,a3,a5,aZ,a2,a1,a0,aU,aX,aW,aV,aQ,aO,aN,aS,aR,aP;if(!aT){throw Error('"assert ⍺" at src/vocabulary/decode.coffee:53')}if(!aT.shape.length){aT=new av([aT.unwrap()])}if(!aY.shape.length){aY=new av([aY.unwrap()])}aU=aT.shape[aT.shape.length-1];aZ=aY.shape[0];if(aU!==1&&aZ!==1&&aU!==aZ){e()}a4=aT.toArray();a3=aY.toArray();a5=[];for(a2=aQ=0,aS=a4.length/aU;0<=aS?aQ<aS:aQ>aS;a2=0<=aS?++aQ:--aQ){for(a1=aO=0,aR=a3.length/aZ;0<=aR?aO<aR:aO>aR;a1=0<=aR?++aO:--aO){aX=a4.slice(a2*aU,(a2+1)*aU);aW=(function(){var a7,a6;a6=[];for(a0=a7=0;0<=aZ?a7<aZ:a7>aZ;a0=0<=aZ?++a7:--a7){a6.push(a3[a1+a0*(a3.length/aZ)])}return a6})();if(aX.length===1){aX=(function(){var a7,a8,a6;a6=[];for(a7=0,a8=aW.length;0<=a8?a7<a8:a7>a8;0<=a8?a7++:a7--){a6.push(aX[0])}return a6})()}if(aW.length===1){aW=(function(){var a7,a8,a6;a6=[];for(a7=0,a8=aX.length;0<=a8?a7<a8:a7>a8;0<=a8?a7++:a7--){a6.push(aW[0])}return a6})()}aV=aW[0];for(a0=aN=1,aP=aW.length;1<=aP?aN<aP:aN>aP;a0=1<=aP?++aN:--aN){aV=aV*aX[a0]+aW[a0]}a5.push(aV)}}return new av(a5,aT.shape.slice(0,-1).concat(aY.shape.slice(1)))}});aB({".":ah(function(aN,aO){if(aO===B["∘"]){return Y(aN)}else{return l(aN,aO)}})});Y=function(aN){if(!(typeof aN==="function")){throw Error("\"assert typeof f is 'function'\" at src/vocabulary/dot.coffee:39")}return function(aZ,aQ){var aX,aV,aS,aY,aU,aT,aR,aP,aW,aO;if(!aQ){L("Adverb ∘. (Outer product) can be applied to dyadic verbs only")}aX=aQ.toArray();aV=aZ.toArray();aS=[];for(aR=0,aW=aX.length;aR<aW;aR++){aY=aX[aR];for(aP=0,aO=aV.length;aP<aO;aP++){aU=aV[aP];if(!(aY instanceof av)){aY=av.scalar(aY)}if(!(aU instanceof av)){aU=av.scalar(aU)}aT=aN(aU,aY);if(!aT.shape.length){aT=aT.unwrap()}aS.push(aT)}}return new av(aS,aQ.shape.concat(aZ.shape))}};l=function(aP,aQ){var aO,aN;aO=B["¨"](o(aQ));aN=Y(aP);return function(aS,aR){if(!aR.shape.length){aR=new av([aR.unwrap()])}if(!aS.shape.length){aS=new av([aS.unwrap()])}return aO(aN(B["⊂"](aS,void 0,new av([0])),B["⊂"](aR,void 0,new av([aR.shape.length-1]))))}};aB({"¨":v(function(aO,aN){if(!(typeof aO==="function")){throw Error("\"assert typeof f is 'function'\" at src/vocabulary/each.coffee:18")}if(!(typeof aN==="undefined")){throw Error("\"assert typeof g is 'undefined'\" at src/vocabulary/each.coffee:19")}return function(aS,aQ){var aP,aR;if(!aQ){return aS.map(function(aT){var aU;if(!(aT instanceof av)){aT=new av([aT],[])}aU=aO(aT);if(!(aU instanceof av)){throw Error('"assert r instanceof APLArray" at src/vocabulary/each.coffee:25')}if(aU.shape.length){return aU}else{return aU.unwrap()}})}else{if(d(aQ.shape,aS.shape)){return aS.map2(aQ,function(aT,aV){var aU;if(!(aT instanceof av)){aT=new av([aT],[])}if(!(aV instanceof av)){aV=new av([aV],[])}aU=aO(aT,aV);if(!(aU instanceof av)){throw Error('"assert r instanceof APLArray" at src/vocabulary/each.coffee:32')}if(aU.shape.length){return aU}else{return aU.unwrap()}})}else{if(aQ.isSingleton()){aR=aQ.data[0] instanceof av?aQ.unwrap():aQ;return aS.map(function(aT){var aU;if(!(aT instanceof av)){aT=new av([aT],[])}aU=aO(aT,aR);if(!(aU instanceof av)){throw Error('"assert r instanceof APLArray" at src/vocabulary/each.coffee:39')}if(aU.shape.length){return aU}else{return aU.unwrap()}})}else{if(aS.isSingleton()){aP=aS.data[0] instanceof av?aS.unwrap():aS;return aQ.map(function(aU){var aT;if(!(aU instanceof av)){aU=new av([aU],[])}aT=aO(aP,aU);if(!(aT instanceof av)){throw Error('"assert r instanceof APLArray" at src/vocabulary/each.coffee:46')}if(aT.shape.length){return aT}else{return aT.unwrap()}})}else{return e()}}}}}})});aB({"⊤":function(aW,aS){var a4,a2,a5,a1,aT,a0,aZ,aY,aX,aO,aV,aU,aQ,aP,aN,a3,aR;if(!aS){throw Error('"assert ⍺" at src/vocabulary/encode.coffee:40')}a4=aS.toArray();a2=aW.toArray();aO=aS.shape.concat(aW.shape);a5=Array(aC(aO));aX=aS.shape.length?aS.shape[0]:1;aY=a4.length/aX;for(a1=aQ=0;0<=aY?aQ<aY:aQ>aY;a1=0<=aY?++aQ:--aQ){for(a0=aP=0,a3=a2.length;aP<a3;a0=++aP){aU=a2[a0];if(aT=aU<0){aU=-aU}for(aZ=aN=aR=aX-1;aN>=0;aZ=aN+=-1){aV=a4[aZ*aY+a1];if(aV===0){a5[(aZ*aY+a1)*a2.length+a0]=aU;aU=0}else{a5[(aZ*aY+a1)*a2.length+a0]=aU%aV;aU=Math.round((aU-(aU%aV))/aV)}}}}return new av(a5,aO)}});aB({"∊":function(aQ,aP){var aN,aO;if(aP){aN=aQ.toArray();return aP.map(function(aR){var aU,aT,aS;for(aT=0,aS=aN.length;aT<aS;aT++){aU=aN[aT];if(at(aR,aU)){return 1}}return 0})}else{aO=[];I(aQ,aO);return new av(aO)}}});I=function(aV,aN){var aT,aS,aR,aQ,aP,aY,aX,aW,aU,aO;if(aV instanceof av){aY=aV;if(!aY.empty()){aW=aY.data;aT=aY.shape;aS=aY.stride;aR=aT.length-1;aP=aY.offset;aQ=[];aX=aT.length;while(--aX>=0){aQ.push(0)}aO=[];while(true){aU=aW[aP];I(aU,aN);aX=aR;while(aX>=0&&aQ[aX]+1===aT[aX]){aP-=aQ[aX]*aS[aX];aQ[aX--]=0}if(aX<0){break}aQ[aX]++;aO.push(aP+=aS[aX])}return aO}}else{return aN.push(aV)}};aB({"!":Z(1,V({monad:function(aN,aP,aO){var aQ;if(typeof aN==="number"&&((aP==null)||typeof aP==="number")){if(!((aQ=(aN))===~~aQ)){return z(aN+1)}else{if(aN<0){return aq()}else{if(aN<W.length){return W[aN]}else{return Math.round(z(aN+1))}}}}else{return aq()}},dyad:D=function(aS,aP,aN){var aR,aQ,aO;if(typeof aS==="number"&&((aP==null)||typeof aP==="number")){aR=(function(){switch(4*i(aP)+2*i(aS)+i(aS-aP)){case 0:return Math.exp(aH(aS+1)-aH(aP+1)-aH(aS-aP+1));case 1:return 0;case 2:return aq();case 3:return Math.pow(-1,aP)*D(aP-aS-1,aP);case 4:return 0;case 5:break;case 6:return Math.pow(-1,aS-aP)*D(Math.abs(aP+1),Math.abs(aS+1));case 7:return 0}})();if(((aQ=(aS))===~~aQ)&&((aO=(aP))===~~aO)){return Math.round(aR)}else{return aR}}else{return aq()}}}))});i=function(aN){var aO;return((aO=(aN))===~~aO)&&aN<0};W=(function(){var aO,aN;return[aN=1].concat((function(){var aQ,aP;aP=[];for(aO=aQ=1;aQ<=25;aO=++aQ){aP.push(aN*=aO)}return aP})())})();m=(function(){var aO,aQ,aP,aN;aO=7;aP=[0.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-0.13857109526572012,0.000009984369578019572,1.5056327351493116e-7];aQ=607/128;aN=[0.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-0.4919138160976202,0.00003399464998481189,0.00004652362892704858,-0.00009837447530487956,0.0001580887032249125,-0.00021026444172410488,0.00021743961811521265,-0.0001643181065367639,0.00008441822398385275,-0.000026190838401581408,0.0000036899182659531625];return{lnΓ:function(aW){var aU,aT,aS,aV,aR;if(aW<0){return NaN}aS=aN[0];for(aU=aV=aR=aN.length-1;aV>0;aU=aV+=-1){aS+=aN[aU]/(aW+aU)}aT=aW+aQ+0.5;return 0.5*Math.log(2*Math.PI)+(aW+0.5)*Math.log(aT)-aT+Math.log(aS)-Math.log(aW)},Γ:function(aW){var aU,aT,aS,aV,aR;if(aW<0.5){return Math.PI/(Math.sin(Math.PI*aW)*z(1-aW))}else{if(aW>100){return Math.exp(aH(aW))}else{aW--;aS=aP[0];for(aU=aV=1,aR=aO+2;aV<aR;aU=aV+=1){aS+=aP[aU]/(aW+aU)}aT=aW+aO+0.5;return Math.sqrt(2*Math.PI)*Math.pow(aT,aW+0.5)*Math.exp(-aT)*aS}}}}})(),z=m.Γ,aH=m.lnΓ;aB({"⍎":function(aO,aN){if(aN){return P()}else{return aI(aO.toSimpleString())}}});aB({"⍷":function(aY,aS){var aX,aW,aU,aP,aV,aZ,aQ,aO,aN,aT,aR;if(aS){if(aS.shape.length>aY.shape.length){return new av([0],aY.shape,u([0],aY.shape.length))}if(aS.shape.length<aY.shape.length){aS=new av(aS.data,u([1],aY.shape.length-aS.shape.length).concat(aS.shape),u([0],aY.shape.length-aS.shape.length).concat(aS.stride),aS.offset)}if(aC(aS.shape)===0){return new av([1],aY.shape,u([0],aY.shape.length))}aP=[];for(aV=aT=0,aR=aY.shape.length;0<=aR?aT<aR:aT>aR;aV=0<=aR?++aT:--aT){aW=aY.shape[aV]-aS.shape[aV]+1;if(aW<=0){return new av([0],aY.shape,u([0],aY.shape.length))}aP.push(aW)}aN=aa(aY.shape);aU=u([0],aC(aY.shape));aQ=aY.offset;aO=0;aZ=u([0],aP.length);while(true){aU[aO]=+at(aS,new av(aY.data,aS.shape,aY.stride,aQ));aX=aP.length-1;while(aX>=0&&aZ[aX]+1===aP[aX]){aQ-=aZ[aX]*aY.stride[aX];aO-=aZ[aX]*aN[aX];aZ[aX--]=0}if(aX<0){break}aQ+=aY.stride[aX];aO+=aN[aX];aZ[aX]++}return new av(aU,aY.shape)}else{return P()}}});aB({"⌊":Z(Infinity,V({monad:K.floor,dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return Math.min(aP,aN)}else{return aq()}}})),"⌈":Z(-Infinity,V({monad:K.ceil,dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return Math.max(aP,aN)}else{return aq()}}}))});aB({_fork1:function(aN,aO){if(!(typeof aN==="function")){throw Error("\"assert typeof h is 'function'\" at src/vocabulary/fork.coffee:20")}if(!(typeof aO==="function")){throw Error("\"assert typeof g is 'function'\" at src/vocabulary/fork.coffee:21")}return[aN,aO]},_fork2:function(aN,aQ){var aP,aO;aO=aN[0],aP=aN[1];if(!(typeof aO==="function")){throw Error("\"assert typeof h is 'function'\" at src/vocabulary/fork.coffee:25")}return function(aR,aS){return aP(aO(aR,aS),aQ(aR,aS))}}});aB({"⍕":function(aP,aO){var aN;if(aO){return P()}else{aN=x(aP);return new av(aN.join(""),[aN.length,aN[0].length])}}});x=function(bq){var aN,aQ,bp,a1,bo,a8,bl,bj,bh,aP,aO,a6,ba,a3,bc,bn,a4,a5,a9,a7,bm,bk,bi,bg,a2,aU,aS,bf,be,bd,bb,a0,aZ,aY,aX,aW,aV,aT,aR;if(typeof bq==="undefined"){return["undefined"]}else{if(bq===null){return["null"]}else{if(typeof bq==="string"){return[bq]}else{if(typeof bq==="number"){ba=[(""+bq).replace("Infinity","∞").replace(/-/g,"¯")];ba.align="right";return ba}else{if(typeof bq==="function"){return["λ"]}else{if(!(bq instanceof av)){return[""+bq]}else{if(aC(bq.shape)===0){return[""]}else{a4=bq.shape;bq=bq.toArray();if(!a4.length){return x(bq[0])}a6=aC(a4.slice(0,a4.length-1));aO=a4[a4.length-1];bn=(function(){var bs,br;br=[];for(bs=0;0<=a6?bs<a6:bs>a6;0<=a6?bs++:bs--){br.push({height:0,bottomMargin:0})}return br})();a1=(function(){var bs,br;br=[];for(bs=0;0<=aO?bs<aO:bs>aO;0<=aO?bs++:bs--){br.push({type:0,width:0,leftMargin:0,rightMargin:0})}return br})();a8=(function(){var bt,bs,br;br=[];for(bl=bt=0,bs=bn.length;bt<bs;bl=++bt){ba=bn[bl];br.push((function(){var bw,bu,bv;bv=[];for(bj=bw=0,bu=a1.length;bw<bu;bj=++bw){bp=a1[bj];a7=bq[aO*bl+bj];aQ=x(a7);ba.height=Math.max(ba.height,aQ.length);bp.width=Math.max(bp.width,aQ[0].length);bp.type=Math.max(bp.type,typeof a7==="string"&&a7.length===1?0:!(a7 instanceof av)?1:2);bv.push(aQ)}return bv})())}return br})();a5=1;for(bo=bm=a0=a4.length-2;bm>=1;bo=bm+=-1){a5*=a4[bo];for(bl=bk=aZ=a5-1,aY=a6-1;a5>0?bk<aY:bk>aY;bl=bk+=a5){bn[bl].bottomMargin++}}for(bj=bi=0,a2=a1.length;bi<a2;bj=++bi){bp=a1[bj];if(bj!==aO-1&&!((bp.type===(aX=a1[bj+1].type)&&aX===0))){bp.rightMargin++}if(bp.type===2){bp.leftMargin++;bp.rightMargin++}}a3=[];for(bl=bg=0,aU=bn.length;bg<aU;bl=++bg){ba=bn[bl];for(bj=bf=0,aS=a1.length;bf<aS;bj=++bf){bp=a1[bj];a9=a8[bl][bj];if(a9.align==="right"){aP=u(" ",bp.leftMargin+bp.width-a9[0].length);bc=u(" ",bp.rightMargin)}else{aP=u(" ",bp.leftMargin);bc=u(" ",bp.rightMargin+bp.width-a9[0].length)}for(bh=be=0,aW=a9.length;0<=aW?be<aW:be>aW;bh=0<=aW?++be:--be){a9[bh]=aP+a9[bh]+bc}aN=u(" ",a9[0].length);for(bd=aV=a9.length,aT=ba.height+ba.bottomMargin;aV<=aT?bd<aT:bd>aT;aV<=aT?bd++:bd--){a9.push(aN)}}for(bh=bb=0,aR=ba.height+ba.bottomMargin;0<=aR?bb<aR:bb>aR;bh=0<=aR?++bb:--bb){a3.push(((function(){var bs,br;br=[];for(bj=bs=0;0<=aO?bs<aO:bs>aO;bj=0<=aO?++bs:--bs){br.push(a8[bl][bj][bh])}return br})()).join(""))}}return a3}}}}}}}};aB({"⍋":function(aO,aN){return az(aO,aN,1)},"⍒":function(aO,aN){return az(aO,aN,-1)}});az=function(aW,aR,aV){var aT,a0,aO,aN,a2,a1,aZ,aX,aY,aU,aS,aP,aQ;aT={};if(aR){if(!aR.shape.length){ai()}aT={};aO=aR;if(!aO.empty()){a2=aO.data;a1=aO.shape;aZ=aO.stride;aX=a1.length-1;aY=aO.offset;a0=[];aN=a1.length;while(--aN>=0){a0.push(0)}while(true){aU=a2[aY];if(typeof aU!=="string"){aq()}aT[aU]=a0[a0.length-1];aN=aX;while(aN>=0&&a0[aN]+1===a1[aN]){aY-=a0[aN]*aZ[aN];a0[aN--]=0}if(aN<0){break}a0[aN]++;aY+=aZ[aN]}}}if(!aW.shape.length){ai()}return new av((function(){aQ=[];for(var a3=0,a4=aW.shape[0];0<=a4?a3<a4:a3>a4;0<=a4?a3++:a3--){aQ.push(a3)}return aQ}).apply(this).sort(function(a7,a6){var a5,a8,a4,a3,a9;a8=aW.offset;a0=u([0],aW.shape.length);while(true){aU=aW.data[a8+a7*aW.stride[0]];a9=aW.data[a8+a6*aW.stride[0]];a4=typeof aU;a3=typeof a9;if(a4<a3){return -aV}if(a4>a3){return aV}if(aT[aU]!=null){aU=aT[aU]}if(aT[a9]!=null){a9=aT[a9]}if(aU<a9){return -aV}if(aU>a9){return aV}a5=a0.length-1;while(a5>0&&a0[a5]+1===aW.shape[a5]){a8-=aW.stride[a5]*a0[a5];a0[a5--]=0}if(a5<=0){break}a8+=aW.stride[a5];a0[a5]++}return(a7>a6)-(a7<a6)}))};aB({"⍁":ah(function(aO,aN){var aP;if(aO instanceof av){aP=[aN,aO],aO=aP[0],aN=aP[1]}if(!(typeof aO==="function")){throw Error("\"assert typeof f is 'function'\" at src/vocabulary/identity.coffee:13")}if(!(aN instanceof av)){throw Error('"assert x instanceof APLArray" at src/vocabulary/identity.coffee:14')}if(!aN.isSingleton()){ai()}if(aN.shape.length){aN=av.scalar(aN.unwrap())}return Z(aN,function(aS,aR,aQ){return aO(aS,aR,aQ)})})});aB({"⍳":function(aO,bf){var aV,bo,bn,bm,bk,a0,aZ,aX,bi,bd,bc,a9,aN,a8,a7,a6,a4,a3,a2,a1,aY,a5,bl,bj,bh,bg,aW,be,bb,ba,aU,aT,aS,aR,aQ,aP;if(bf){if(bf.shape.length!==1){ai()}return aO.map(function(bx){var br,bB,bp,bA,by,bw,bv,bt,bs,bq,bu;try{bp=bf.shape;bA=bf;if(!bA.empty()){bw=bA.data;bv=bA.shape;bt=bA.stride;bs=bv.length-1;bq=bA.offset;bB=[];by=bv.length;while(--by>=0){bB.push(0)}while(true){bu=bw[bq];if(at(bx,bu)){bp=bB;throw"break"}by=bs;while(by>=0&&bB[by]+1===bv[by]){bq-=bB[by]*bt[by];bB[by--]=0}if(by<0){break}bB[by]++;bq+=bt[by]}}}catch(bz){br=bz;if(br!=="break"){throw br}}if(bp.length===1){return bp[0]}else{return new av(bp)}})}else{if(aO.shape.length>1){ai()}bo=aO.toArray();for(bl=0,aW=bo.length;bl<aW;bl++){bn=bo[bl];if(!((aY=(bn))===~~aY&&(0)<=aY)){aq()}}bc=aC(bo);if(!bc){bm=[]}else{if(bo.length===1){bm=bc<=256?new Uint8Array(bc):bc<=65536?new Uint16Array(bc):bc<=4294967296?new Uint32Array(bc):aq();for(bk=bj=0;bj<bc;bk=bj+=1){bm[bk]=bk}}else{bd=Math.max.apply(Math,bo);aV=bd<=256?Uint8Array:bd<=65536?Uint16Array:bd<=4294967296?Uint32Array:aq();a0=new aV(bc*bo.length);a5=bc;for(bk=bh=0,aU=bo.length;bh<aU;bk=bh+=1){a5/=bo[bk];a9=bc*bk;for(bi=bg=0,aT=bo[bk];bg<aT;bi=bg+=1){a0[a9]=bi;aN=a0;a8=a9;a7=1;a6=a5;if(aN instanceof Array){for(bi=be=aS=a7,aR=a6;be<aR;bi=be+=1){aN[a8+bi]=aN[a8+bi%a7]}}else{aN=aN.subarray(a8,a8+a6);while(2*a7<a6){aN.set(aN.subarray(0,a7),a7);a7*=2}aN.set(aN.subarray(0,a6-a7),a7)}a9+=a5}a4=a0;a3=bc*bk;a2=bo[bk]*a5;a1=bc;if(a4 instanceof Array){for(bi=bb=aQ=a2,aP=a1;bb<aP;bi=bb+=1){a4[a3+bi]=a4[a3+bi%a2]}}else{a4=a4.subarray(a3,a3+a1);while(2*a2<a1){a4.set(a4.subarray(0,a2),a2);a2*=2}a4.set(a4.subarray(0,a1-a2),a2)}}bm=[];aZ=[bo.length];aX=[bc];for(bk=ba=0;ba<bc;bk=ba+=1){bm.push(new av(a0,aZ,aX,bk))}}}return new av(bm,bo)}}});aB({"⊂":function(a1,aU,a4){var a8,a5,aV,a2,a7,aQ,a3,a0,aZ,aY,aP,aO,aN,aX,a6,aW,aS,aT,aR;if(!(!aU)){throw Error('"assert !⍺" at src/vocabulary/leftshoe.coffee:13')}a4=a4!=null?af(a4,a1.shape.length):(function(){aR=[];for(var a9=0,ba=a1.shape.length;0<=ba?a9<ba:a9>ba;0<=ba?a9++:a9--){aR.push(a9)}return aR}).apply(this);if(a1.isSimple()){return a1}aX=(function(){var bb,a9,ba;ba=[];for(bb=0,a9=a4.length;bb<a9;bb++){a5=a4[bb];ba.push(a1.shape[a5])}return ba})();a6=(function(){var bb,a9,ba;ba=[];for(bb=0,a9=a4.length;bb<a9;bb++){a5=a4[bb];ba.push(a1.stride[a5])}return ba})();a7=(function(){var ba,bb,a9;a9=[];for(a5=ba=0,bb=a1.shape.length;0<=bb?ba<bb:ba>bb;a5=0<=bb?++ba:--ba){if(aF.call(a4,a5)<0){a9.push(a5)}}return a9})();aQ=(function(){var bb,a9,ba;ba=[];for(bb=0,a9=a7.length;bb<a9;bb++){a5=a7[bb];ba.push(a1.shape[a5])}return ba})();a3=(function(){var bb,a9,ba;ba=[];for(bb=0,a9=a7.length;bb<a9;bb++){a5=a7[bb];ba.push(a1.stride[a5])}return ba})();a8=[];a0=new av(a1.data,aQ,a3,a1.offset);if(!a0.empty()){aY=a0.data;aP=a0.shape;aO=a0.stride;aN=aP.length-1;a2=a0.offset;aV=[];aZ=aP.length;while(--aZ>=0){aV.push(0)}while(true){aW=aY[a2];a8.push(new av(a1.data,aX,a6,a2));aZ=aN;while(aZ>=0&&aV[aZ]+1===aP[aZ]){a2-=aV[aZ]*aO[aZ];aV[aZ--]=0}if(aZ<0){break}aV[aZ]++;a2+=aO[aZ]}}return new av(a8,aQ)}});aB({"~":V({monad:function(aN){return +(!ab(aN))}}),"∨":Z(0,V({dyad:function(aO,aN){if((!K.isint(aN))||(!K.isint(aO))){aq("∨ is implemented only for Gaussian integers")}return K.gcd(aN,aO)}})),"∧":Z(1,V({dyad:function(aO,aN){if((!K.isint(aN))||(!K.isint(aO))){aq("∧ is implemented only for Gaussian integers")}return K.lcm(aN,aO)}})),"⍱":V({dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return +(!(ab(aN)|ab(aP)))}else{return aq()}}}),"⍲":V({dyad:function(aP,aN,aO){if(typeof aP==="number"&&((aN==null)||typeof aN==="number")){return +(!(ab(aN)&ab(aP)))}else{return aq()}}})});aB({"⍣":ah(function(aO,aP){var aN,aQ;if(aP instanceof av&&typeof aO==="function"){aN=aP;aP=aO;aO=aN}else{if(!(typeof aP==="function")){throw Error("\"assert typeof f is 'function'\" at src/vocabulary/poweroperator.coffee:15")}}if(typeof aO==="function"){return function(aT,aS){var aR;while(true){aR=aP(aT,aS);if(aO(aT,aR).toBool()){return aT}aT=aR}}}else{aQ=aO.toInt(0);return function(aT,aS){var aR;for(aR=0;0<=aQ?aR<aQ:aR>aQ;0<=aQ?aR++:aR--){aT=aP(aT,aS)}return aT}}})});aB({"get_⎕":function(){if(typeof(typeof window!=="undefined"&&window!==null?window.prompt:void 0)==="function"){return new av(prompt("⎕:")||"")}else{return P("Reading from ⎕ is not implemented.")}},"set_⎕":function(aN){var aO;aO=x(aN).join("\n")+"\n";if(typeof(typeof window!=="undefined"&&window!==null?window.alert:void 0)==="function"){window.alert(aO)}else{process.stdout.write(aO)}return aN},"get_⍞":function(){if(typeof(typeof window!=="undefined"&&window!==null?window.prompt:void 0)==="function"){return prompt("")||""}else{return P("Reading from ⍞ is not implemented.")}},"set_⍞":function(aN){var aO;aO=x(aN).join("\n");if(typeof(typeof window!=="undefined"&&window!==null?window.alert:void 0)==="function"){window.alert(aO)}else{process.stdout.write(aO)}return aN},"get_⎕IO":function(){return av.zero},"set_⎕IO":function(aN){if(at(aN,av.zero)){return aN}else{return aq("The index origin (⎕IO) is fixed at 0")}},"⎕DL":p(function(aR,aP,aN,aQ){var aO;aO=+(new Date);setTimeout((function(){return aQ(new av([new Date-aO]))}),aR.unwrap())}),"⎕RE":function(aV,aP){var aR,aO,aN,aY,aX,aU,aS,aQ,aT;aU=aP.toSimpleString();aS=aV.toSimpleString();try{aY=new RegExp(aU)}catch(aW){aR=aW;aq(aR.toString())}if(aO=aY.exec(aS)){aN=[aO.index];for(aQ=0,aT=aO.length;aQ<aT;aQ++){aX=aO[aQ];aN.push(new av(aX||""))}return new av(aN)}else{return av.zilde}},"⎕UCS":function(aO,aN){if(aN!=null){P()}return aO.map(function(aP){var aQ,aS,aR;if((aQ=(aP))===~~aQ&&((0)<=(aR=aQ)&&aR<(65536))){return aS=String.fromCharCode(aP)}else{if(typeof aP==="string"){return aS=aP.charCodeAt(0)}else{return aq()}}})}});aB({"?":function(aO,aN){if(aN){return s(aO,aN)}else{return R(aO)}}});R=V({monad:function(aO){var aN;if(!((aN=aO)===~~aN&&(1)<=aN)){aq()}return Math.floor(Math.random()*aO)}});s=function(aX,aS){var aW,aV,aU,aN,aO,aY,aT,aR,aP,aQ;aS=aS.unwrap();aX=aX.unwrap();if(!(((aO=aX)===~~aO&&(0)<=aO)&&((aY=aS)===~~aY&&((0)<=(aP=aY)&&aP<(aX+1))))){aq()}aN=(function(){aQ=[];for(var aZ=0;0<=aX?aZ<aX:aZ>aX;0<=aX?aZ++:aZ--){aQ.push(aZ)}return aQ}).apply(this);for(aV=aR=0;aR<aS;aV=aR+=1){aU=aV+Math.floor(Math.random()*(aX-aV));aW=aN[aV];aN[aV]=aN[aU];aN[aU]=aW}return new av(aN.slice(0,aS))};aB({"↗":function(aN){return aG(aN.toString())}});aB({"⍴":function(aZ,aO){var a4,a5,a2,a0,aX,aW,aV,aU,aT,aS,aQ,aP,a1,aY,aN,a3;if(aO){if(aO.shape.length>1){ai()}a4=aO.toArray();for(aN=0,a3=a4.length;aN<a3;aN++){aY=a4[aN];if(!((a1=(aY))===~~a1&&(0)<=a1)){aq()}}a0=aC(a4);if(!a0){return new av([],a4)}else{if((a4.length>=aZ.shape.length)&&d(aZ.shape,a4.slice(a4.length-aZ.shape.length))){return new av(aZ.data,a4,u([0],a4.length-aZ.shape.length).concat(aZ.stride),aZ.offset)}else{a5=[];try{aX=aZ;if(!aX.empty()){aV=aX.data;aU=aX.shape;aT=aX.stride;aS=aU.length-1;aP=aX.offset;aQ=[];aW=aU.length;while(--aW>=0){aQ.push(0)}while(true){aY=aV[aP];if(a5.length>=a0){throw"break"}a5.push(aY);aW=aS;while(aW>=0&&aQ[aW]+1===aU[aW]){aP-=aQ[aW]*aT[aW];aQ[aW--]=0}if(aW<0){break}aQ[aW]++;aP+=aT[aW]}}}catch(aR){a2=aR;if(a2!=="break"){throw a2}}if(a5.length){while(2*a5.length<a0){a5=a5.concat(a5)}if(a5.length!==a0){a5=a5.concat(a5.slice(0,a0-a5.length))}}else{a5=u([aZ.getPrototype()],a0)}return new av(a5,a4)}}}else{return new av(aZ.shape)}}});aB({"⌽":ad=function(a0,aS,aR){var aZ,aU,a1,aQ,aT,aO,aW,aP,aN,aY,aV,aX;if(!(typeof aR==="undefined"||aR instanceof av)){throw Error("\"assert typeof axis is 'undefined' or axis instanceof APLArray\" at src/vocabulary/rotate.coffee:4")}if(aS){aR=!aR?a0.shape.length-1:aR.unwrap();if(!((aY=(aR))===~~aY)){aq()}if(a0.shape.length&&!((0<=aR&&aR<a0.shape.length))){C()}aP=aS.unwrap();if(!((aV=(aP))===~~aV)){aq()}if(!aP){return a0}aQ=a0.shape[aR];aP=(aQ+(aP%aQ))%aQ;if(a0.empty()||aP===0){return a0}aU=[];aW=a0.shape,aN=a0.stride;aO=a0.offset;a1=u([0],aW.length);while(true){aU.push(a0.data[aO+((a1[aR]+aP)%aW[aR]-a1[aR])*aN[aR]]);aZ=aW.length-1;while(aZ>=0&&a1[aZ]+1===aW[aZ]){aO-=a1[aZ]*aN[aZ];a1[aZ--]=0}if(aZ<0){break}a1[aZ]++;aO+=aN[aZ]}return new av(aU,aW)}else{if(aR){if(!aR.isSingleton()){e()}aR=aR.unwrap();if(!((aX=(aR))===~~aX)){aq()}if(!((0<=aR&&aR<a0.shape.length))){C()}}else{aR=[a0.shape.length-1]}if(a0.shape.length===0){return a0}aN=a0.stride.slice(0);aN[aR]=-aN[aR];aT=a0.offset+(a0.shape[aR]-1)*a0.stride[aR];return new av(a0.data,a0.shape,aN,aT)}},"⊖":function(aP,aO,aN){if(aN==null){aN=av.zero}return ad(aP,aO,aN)}});aB({"/":v(function(aP,aO,aN){if(typeof aP==="function"){return o(aP,aO,aN)}else{return T(aP,aO,aN)}}),"⌿":v(function(aP,aO,aN){if(aN==null){aN=av.zero}if(typeof aP==="function"){return o(aP,aO,aN)}else{return T(aP,aO,aN)}})});o=this.reduce=function(aP,aO,aN){if(!(typeof aP==="function")){throw Error("\"assert typeof f is 'function'\" at src/vocabulary/slash.coffee:36")}if(!(typeof aO==="undefined")){throw Error("\"assert typeof g is 'undefined'\" at src/vocabulary/slash.coffee:37")}if(!((typeof aN==="undefined")||(aN instanceof av))){throw Error("\"assert((typeof axis0 is 'undefined') or (axis0 instanceof APLArray))\" at src/vocabulary/slash.coffee:38")}return function(a3,aW){var a8,aV,a9,a7,aX,a5,aY,aQ,a6,a4,aZ,aS,a2,a1,a0,aT,aR,aU;if(!a3.shape.length){a3=new av([a3.unwrap()])}aV=aN!=null?aN.toInt():a3.shape.length-1;if(!((0<=aV&&aV<a3.shape.length))){ai()}if(aW){aQ=true;a6=aW.toInt();if(a6<0){a5=true;a6=-a6}}else{a6=a3.shape[aV];aY=true}aS=a3.shape.slice(0);aS[aV]=a3.shape[aV]-a6+1;aZ=aS;if(aQ){if(aS[aV]===0){return new av([],aZ)}if(aS[aV]<0){e()}}else{aZ=aZ.slice(0);aZ.splice(aV,1)}if(a3.empty()){if((a0=aP.identity)!=null){if(!(!a0.shape.length)){throw Error('"assert !⍴⍴ z" at src/vocabulary/slash.coffee:66')}return new av(a0.data,aZ,u([0],aZ.length),a0.offset)}else{aq()}}a9=[];aX=u([0],aS.length);a4=a3.offset;while(true){if(a5){a2=a3.data[a4];a2=a2 instanceof av?a2:av.scalar(a2);for(a7=aT=1;aT<a6;a7=aT+=1){a1=a3.data[a4+a7*a3.stride[aV]];a1=a1 instanceof av?a1:av.scalar(a1);a2=aP(a2,a1)}}else{a2=a3.data[a4+(a6-1)*a3.stride[aV]];a2=a2 instanceof av?a2:av.scalar(a2);for(a7=aR=aU=a6-2;aR>=0;a7=aR+=-1){a1=a3.data[a4+a7*a3.stride[aV]];a1=a1 instanceof av?a1:av.scalar(a1);a2=aP(a2,a1)}}if(!a2.shape.length){a2=a2.unwrap()}a9.push(a2);a8=aX.length-1;while(a8>=0&&aX[a8]+1===aS[a8]){a4-=aX[a8]*a3.stride[a8];aX[a8--]=0}if(a8<0){break}a4+=a3.stride[a8];aX[a8]++}return new av(a9,aZ)}};T=function(aW,aT,aS){var a2,a1,a4,aN,a0,aU,aZ,aX,aO,aY,aV,aQ,aP,a3,aR;if(!aW.shape.length){aW=new av([aW.unwrap()])}aS=aS?aS.toInt(0,aW.shape.length):aW.shape.length-1;if(aT.shape.length>1){ai()}a2=aT.toArray();aZ=aW.shape[aS];if(a2.length===1){a2=u(a2,aZ)}if(aZ!==1&&aZ!==a2.length){e()}aO=aW.shape.slice(0);aO[aS]=0;a1=[];for(a0=aQ=0,a3=a2.length;aQ<a3;a0=++aQ){aV=a2[a0];if(!((aY=(aV))===~~aY)){aq()}aO[aS]+=Math.abs(aV);for(aP=0,aR=Math.abs(aV);0<=aR?aP<aR:aP>aR;0<=aR?aP++:aP--){a1.push(aV>0?a0:null)}}if(aZ===1){a1=(function(){var a7,a6,a5;a5=[];for(a7=0,a6=a1.length;a7<a6;a7++){aV=a1[a7];a5.push(aV!=null?0:aV)}return a5})()}a4=[];if(aO[aS]!==0&&!aW.empty()){aN=aW.getPrototype();aX=aW.offset;aU=u([0],aO.length);while(true){aV=a1[aU[aS]]!=null?aW.data[aX+a1[aU[aS]]*aW.stride[aS]]:aN;a4.push(aV);a0=aO.length-1;while(a0>=0&&aU[a0]+1===aO[a0]){if(a0!==aS){aX-=aW.stride[a0]*aU[a0]}aU[a0--]=0}if(a0<0){break}if(a0!==aS){aX+=aW.stride[a0]}aU[a0]++}}return new av(a4,aO)};aB({"⌷":y=function(a2,aU,aZ){var a1,aP,aX,aW,aN,aY,a3,aV,aT,aR,a0,aQ,aO,aS;if(typeof a2==="function"){return function(a4,a5){return a2(a4,a5,aU)}}if(!aU){P()}if(1<aU.shape.length){ai()}a1=aU.toArray();if(a1.length>a2.shape.length){e()}if(aZ){aZ=aZ.toArray();if(a1.length!==aZ.length){e()}aX=Array(a2.shape.length);for(aV=0,a0=aZ.length;aV<a0;aV++){aP=aZ[aV];if(!((aY=(aP))===~~aY)){aq()}if(!((0<=aP&&aP<a2.shape.length))){ai()}if(aX[aP]){ai("Duplicate axis")}aX[aP]=1}}else{aZ=(function(){aS=[];for(var a4=0,a5=a1.length;0<=a5?a4<a5:a4>a5;0<=a5?a4++:a4--){aS.push(a4)}return aS}).apply(this)}aN=a2;for(aW=aR=aO=a1.length-1;aR>=0;aW=aR+=-1){a3=a1[aW] instanceof av?a1[aW]:new av([a1[aW]],[]);aN=ak(aN,a3,aZ[aW])}return aN},_index:function(aN,aR){var aP,aO,aQ;aQ=aN.toArray(),aP=aQ[0],aO=aQ[1];return y(aR,aP,aO)},_substitute:function(aX){var bh,aY,bd,bj,be,a4,a7,ba,bf,bc,a9,a8,a6,a5,a3,a2,aS,aP,aO,aN,bk,bi,a1,a0,bb,aZ,aV,aR,bg,aW,aU,aQ,aT;aW=(function(){var bn,bm,bo,bl;bo=aX.toArray();bl=[];for(bn=0,bm=bo.length;bn<bm;bn++){aZ=bo[bn];if(aZ instanceof av){bl.push(aZ)}else{bl.push(new av([aZ],[]))}}return bl})(),bb=aW[0],aY=aW[1],a4=aW[2],bd=aW[3];if(1<aY.shape.length){ai()}bh=aY.toArray();if(bh.length>a4.shape.length){e()}if(bd){if(1<bd.shape.length){ai()}bd=bd.toArray();if(bh.length!==bd.length){e()}}else{bd=(function(){aT=[];for(var bl=0,bm=bh.length;0<=bm?bl<bm:bl>bm;0<=bm?bl++:bl--){aT.push(bl)}return aT}).apply(this)}bf=y(B["⍳"](new av(a4.shape)),aY,new av(bd));if(bb.isSingleton()){bb=new av([bb],bf.shape,u([0],bf.shape.length))}bj=a4.toArray();ba=aa(a4.shape);bc=bf;a3=bc.data;aS=bc.shape;aO=bc.stride;a9=bb;a2=a9.data;aP=a9.shape;aN=a9.stride;if(aS.length!==aP.length){ai()}a5=aS.length;while(--a5>=0){if(aS[a5]!==aP[a5]){e()}}if(!bc.empty()){bk=aS.length-1;a8=bc.offset;a6=a9.offset;bi=Array((a5=aS.length));while(--a5>=0){bi[a5]=0}while(true){a1=a3[a8];a0=a2[a6];if(a0 instanceof av&&!a0.shape.length){a0=a0.unwrap()}if(a1 instanceof av){a7=0;aQ=a1.toArray();for(be=aR=0,bg=aQ.length;aR<bg;be=++aR){aZ=aQ[be];a7+=aZ*ba[be]}bj[a7]=a0}else{bj[a1]=a0}a5=bk;while(a5>=0&&bi[a5]+1===aS[a5]){a8-=bi[a5]*aO[a5];a6-=bi[a5]*aN[a5];bi[a5--]=0}if(a5<0){break}bi[a5]++;a8+=aO[a5];a6+=aN[a5]}}return new av(bj,a4.shape)}});ak=function(aP,a6,aQ){var aO,bm,bl,bj,a8,bg,be,ba,a2,aY,a7,aN,a5,a4,a3,aW,aV,aU,aT,aS,aR,bd,bc,bb,a9,bk,bi,bh,bf,a1,aX,a0,aZ;if(!(aP instanceof av)){throw Error('"assert ⍵ instanceof APLArray" at src/vocabulary/squish.coffee:122')}if(!(a6 instanceof av)){throw Error('"assert sub instanceof APLArray" at src/vocabulary/squish.coffee:123')}if(!((bd=(aQ))===~~bd)){throw Error('"assert isInt ax" at src/vocabulary/squish.coffee:124')}if(!((0<=aQ&&aQ<aP.shape.length))){throw Error('"assert 0 <= ax < ⍴⍴ ⍵" at src/vocabulary/squish.coffee:125')}bb=a6.toArray();be=aP.shape[aQ];for(bk=0,a1=bb.length;bk<a1;bk++){a9=bb[bk];if(!((bc=(a9))===~~bc)){aq()}if(!((0<=a9&&a9<be))){C()}}a8=false;if(bb.length>=2){a8=true;bm=bb[1]-bb[0];for(bj=bi=2,a0=bb.length;bi<a0;bj=bi+=1){if(bb[bj]-bb[bj-1]!==bm){a8=false;break}}}if(a8){a2=aP.shape.slice(0);a2.splice.apply(a2,[aQ,1].concat(r.call(a6.shape)));a7=aP.stride.slice(0);a5=aa(a6.shape);for(bj=bh=0,aX=a5.length;bh<aX;bj=++bh){a9=a5[bj];a5[bj]=a9*bm*aP.stride[aQ]}a7.splice.apply(a7,[aQ,1].concat(r.call(a5)));ba=aP.offset+bb[0]*aP.stride[aQ];return new av(aP.data,a2,a7,ba)}else{aY=aP.shape.slice(0);aY.splice(aQ,1);aN=aP.stride.slice(0);aN.splice(aQ,1);bl=[];a4=a6;if(!a4.empty()){aW=a4.data;aV=a4.shape;aU=a4.stride;aT=aV.length-1;aR=a4.offset;aS=[];a3=aV.length;while(--a3>=0){aS.push(0)}while(true){a9=aW[aR];aO=new av(aP.data,aY,aN,aP.offset+a9*aP.stride[aQ]);bl.push.apply(bl,aO.toArray());a3=aT;while(a3>=0&&aS[a3]+1===aV[a3]){aR-=aS[a3]*aU[a3];aS[a3--]=0}if(a3<0){break}aS[a3]++;aR+=aU[a3]}}a2=aY.slice(0);a7=aa(a2);a2.splice.apply(a2,[aQ,0].concat(r.call(a6.shape)));a5=aa(a6.shape);bg=aC(aY);for(bj=bf=0,aZ=a5.length;bf<aZ;bj=bf+=1){a5[bj]*=bg}a7.splice.apply(a7,[aQ,0].concat(r.call(a5)));return new av(bl,a2,a7)}};aB({"↑":function(aO,aN){if(aN){return n(aO,aN)}else{return ap(aO)}}});n=function(a1,aW){var a8,aU,aV,a0,bb,a5,aZ,aX,a3,a2,aQ,a4,aY,aS,aR,aP,aO,a7,ba,a9,a6,aN,aT;if(aW.shape.length>1){ai()}if(!a1.shape.length){a1=new av([a1.unwrap()],(!aW.shape.length?[1]:u([1],aW.shape[0])))}a8=aW.toArray();if(a8.length>a1.shape.length){ai()}for(aS=0,a7=a8.length;aS<a7;aS++){aY=a8[aS];if(typeof aY!=="number"||aY!==Math.floor(aY)){aq()}}aZ=false;aQ=a1.shape.slice(0);for(a5=aR=0,ba=a8.length;aR<ba;a5=++aR){aY=a8[a5];aQ[a5]=Math.abs(aY);if(aQ[a5]>a1.shape[a5]){aZ=true}}if(aZ){a4=Array(aQ.length);a4[a4.length-1]=1;for(a5=aP=aT=a4.length-2;aP>=0;a5=aP+=-1){a4[a5]=a4[a5+1]*aQ[a5+1]}bb=u([a1.getPrototype()],aC(aQ));a0=aQ.slice(0);a3=a1.offset;a2=0;for(a5=aO=0,a9=a8.length;aO<a9;a5=++aO){aY=a8[a5];a0[a5]=Math.min(a1.shape[a5],Math.abs(aY));if(aY<0){if(aY<-a1.shape[a5]){a2-=(aY+a1.shape[a5])*a4[a5]}else{a3+=(aY+a1.shape[a5])*a1.stride[a5]}}}if(aC(a0)){aV=u([0],a0.length);while(true){bb[a2]=a1.data[a3];aU=a0.length-1;while(aU>=0&&aV[aU]+1===a0[aU]){a3-=aV[aU]*a1.stride[aU];a2-=aV[aU]*a4[aU];aV[aU--]=0}if(aU<0){break}a3+=a1.stride[aU];a2+=a4[aU];aV[aU]++}}return new av(bb,aQ,a4)}else{aX=a1.offset;for(a5=aN=0,a6=a8.length;aN<a6;a5=++aN){aY=a8[a5];if(aY<0){aX+=(a1.shape[a5]+aY)*a1.stride[a5]}}return new av(a1.data,aQ,a1.stride,aX)}};ap=function(aO){var aN;aN=aO.empty()?aO.getPrototype():aO.data[aO.offset];if(aN instanceof av){return aN}else{return new av([aN],[])}};aB({"⍉":function(aZ,aS){var aU,aP,aV,aN,aW,a0,aY,aT,aR,aX,aO,aQ;if(aS){if(aS.shape.length>1){ai()}if(!aS.shape.length){aS=new av([aS.unwrap()])}aP=aZ.shape.length;if(aS.shape[0]!==aP){e()}aV=[];aN=[];aQ=aS.toArray();for(aU=aT=0,aX=aQ.length;aT<aX;aU=++aT){aY=aQ[aU];if(!((aW=(aY))===~~aW&&(0)<=aW)){aq()}if(aY>=aP){ai()}if(aV[aY]!=null){aV[aY]=Math.min(aV[aY],aZ.shape[aU]);aN[aY]+=aZ.stride[aU]}else{aV[aY]=aZ.shape[aU];aN[aY]=aZ.stride[aU]}}for(aR=0,aO=aV.length;aR<aO;aR++){a0=aV[aR];if(a0==null){ai()}}return new av(aZ.data,aV,aN,aZ.offset)}else{return new av(aZ.data,g(aZ.shape),g(aZ.stride),aZ.offset)}}});aB({"⍠":ah(function(aO,aN){if(!(typeof aO==="function")){throw Error("\"assert typeof f is 'function'\" at src/vocabulary/variant.coffee:8")}if(!(typeof aN==="function")){throw Error("\"assert typeof g is 'function'\" at src/vocabulary/variant.coffee:9")}return function(aR,aQ,aP){return(aQ!=null?aO:aN)(aR,aQ,aP)}})});k=[1,2,3,4],O=k[0],U=k[1],aD=k[2],Q=k[3];aI=function(aO,aN){var aP,aQ,aU,aT,aX,aW,aV,aS,aR;if(aN==null){aN={}}aP=an(aO,aN);aQ=a(aP,aN);aU=[w.env[0].slice(0)];aS=aP.vars;for(aT in aS){aW=aS[aT];aU[0][aW.slot]=aN.ctx[aT]}aX=J({code:aQ,env:aU});aR=aP.vars;for(aT in aR){aW=aR[aT];aV=aN.ctx[aT]=aU[0][aW.slot];if(aW.category===aD){aV.isAdverb=true}if(aW.category===Q){aV.isConjunction=true}}return aX};f=function(aN){var aP,aO,aR,aQ;if(aN===null||((aQ=typeof aN)==="string"||aQ==="number"||aQ==="boolean")){return JSON.stringify(aN)}else{if(aN instanceof Array){return"["+(((function(){var aU,aT,aS;aS=[];for(aU=0,aT=aN.length;aU<aT;aU++){aR=aN[aU];aS.push(f(aR))}return aS})()).join(","))+"]"}else{if(aN.repr){return aN.repr()}else{return"{"+(((function(){var aS;aS=[];for(aP in aN){aO=aN[aP];aS.push(""+(f(aP))+":"+(f(aO)))}return aS})()).join(","))+"}"}}}};a=function(aO,aN){var aX,aS,aU,aW,aP,a0,aR,aY,aZ,aV,aT,aQ;if(aN==null){aN={}}aO.scopeDepth=0;aO.nSlots=w.nSlots;aO.vars=Object.create(w.vars);(function(){var a3,a2,a4,a5,a1;if(aN.ctx==null){aN.ctx=Object.create(B)}a5=aN.ctx;a1=[];for(a3 in a5){a2=a5[a3];if(!(!aO.vars[a3])){continue}aO.vars[a3]=a4={category:O,slot:aO.nSlots++,scopeDepth:aO.scopeDepth};if(typeof a2==="function"||a2 instanceof aM){a4.category=a2.isAdverb?aD:a2.isConjunction?Q:U;if(/^[gs]et_.*/.test(a3)){a1.push(aO.vars[a3.slice(4)]={category:O})}else{a1.push(void 0)}}else{a1.push(void 0)}}return a1})();aS=function(a2,a1){return L(a1,{file:aN.file,offset:a2.offset,aplCode:aN.aplCode})};if(!((U<aD&&aD<Q))){throw Error('"assert VERB < ADVERB < CONJUNCTION # we are relying on this ordering below" at src/compiler.coffee:36')}(aX=function(a3){var a1,a2,a4,a5;switch(a3[0]){case"B":case":":case"←":case"[":case"{":case".":case"⍬":a2=U;for(a1=a4=1,a5=a3.length;a4<a5;a1=a4+=1){if(a3[a1]){a2=Math.max(a2,aX(a3[a1]))}}if(a3[0]==="{"){a3.category=a2;return U}else{return a2}break;case"S":case"N":case"J":return 0;case"X":switch(a3[1]){case"⍺⍺":case"⍶":case"∇∇":return aD;case"⍵⍵":case"⍹":return Q;default:return U}break;default:if(!(0)){throw Error('"else assert 0" at src/compiler.coffee:49')}}})(aO);aW=[aO];while(aW.length){aY=(aR=aW.shift()).vars;aZ=function(bf){var bl,bc,bj,bi,bh,bg,br,be,bd,bb,ba,a8,a6,a4,a2,bq,bo,bm,bk,a9,a7,a5,a3,a1,bp,bn;bf.scopeNode=aR;switch(bf[0]){case":":be=aZ(bf[1]);aZ(bf[2]);return be;case"←":return aV(bf[1],aZ(bf[2]));case"X":br=bf[1];if(((a9=(bd=aY["get_"+br]))!=null?a9.category:void 0)===U){return O}else{return((a7=aY[br])!=null?a7.category:void 0)||aK("Symbol '"+br+"' is referenced before assignment.",{file:aN.file,offset:bf.offset,aplCode:aN.aplCode})}break;case"{":for(bh=ba=1,a5=bf.length;1<=a5?ba<a5:ba>a5;bh=1<=a5?++ba:--ba){aW.push(al((bc=bf[bh]),{scopeNode:aR,scopeDepth:bj=aR.scopeDepth+1+(bf.category!==U),nSlots:3,vars:bd=al(Object.create(aY),{"⍵":{slot:0,scopeDepth:bj,category:O},"∇":{slot:1,scopeDepth:bj,category:U},"⍺":{slot:2,scopeDepth:bj,category:O}})}));if(bf.category===Q){bd["⍵⍵"]=bd["⍹"]={slot:0,scopeDepth:bj-1,category:U};bd["∇∇"]={slot:1,scopeDepth:bj-1,category:Q};bd["⍺⍺"]=bd["⍶"]={slot:2,scopeDepth:bj-1,category:U}}else{if(bf.category===aD){bd["⍺⍺"]=bd["⍶"]={slot:0,scopeDepth:bj-1,category:U};bd["∇∇"]={slot:1,scopeDepth:bj-1,category:aD}}}}return(a3=bf.category)!=null?a3:U;case"S":case"N":case"J":case"⍬":return O;case"[":for(bh=a8=2,a1=bf.length;a8<a1;bh=a8+=1){if(bf[bh]&&aZ(bf[bh])!==O){aS(bf,"Indices must be nouns.")}}return aZ(bf[1]);case".":bl=bf.slice(1);bi=Array(bl.length);for(bh=a6=bp=bl.length-1;a6>=0;bh=a6+=-1){bi[bh]=aZ(bl[bh])}bh=0;while(bh<bl.length-1){if((bi[bh]===(bn=bi[bh+1])&&bn===O)){bg=bh+2;while(bg<bl.length&&bi[bg]===O){bg++}[].splice.apply(bl,[bh,bg-bh].concat(a4=[["V"].concat(bl.slice(bh,bg))])),a4;[].splice.apply(bi,[bh,bg-bh].concat(O)),O}else{bh++}}bh=bl.length-2;while(--bh>=0){if(bi[bh+1]===Q&&(bi[bh]!==O||bi[bh+2]!==O)){[].splice.apply(bl,[bh,(bh+3)-bh].concat(a2=[["C"].concat(bl.slice(bh,bh+3))])),a2;[].splice.apply(bi,[bh,(bh+3)-bh].concat(U)),U;bh--}}bh=0;while(bh<bl.length-1){if(bi[bh]!==O&&bi[bh+1]===aD){[].splice.apply(bl,[bh,(bh+2)-bh].concat(bq=[["A"].concat(bl.slice(bh,bh+2))])),bq;[].splice.apply(bi,[bh,(bh+2)-bh].concat(U)),U}else{bh++}}if(bi.length===2&&bi[0]!==O&&bi[1]!==O){bl=[["H"].concat(bl)];bi=[U]}if(bi.length>=3&&bi.length%2===1&&aE((function(){var bu,bt,bs;bs=[];for(bu=0,bt=bi.length;bu<bt;bu++){bb=bi[bu];bs.push(bb!==O)}return bs})())){bl=[["F"].concat(bl)];bi=[U]}if(bi[bi.length-1]!==O){if(bi.length>1){aS(bl[bi.length-1],"Trailing function in expression")}}else{while(bi.length>1){if(bi.length===2||bi[bi.length-3]!==O){[].splice.apply(bl,[-2,9000000000].concat(bo=[["M"].concat(bl.slice(-2))])),bo;[].splice.apply(bi,[-2,9000000000].concat(O)),O}else{[].splice.apply(bl,[-3,9000000000].concat(bm=[["D"].concat(bl.slice(-3))])),bm;[].splice.apply(bi,[-3,9000000000].concat(O)),O}}}[].splice.apply(bf,[0,9000000000].concat(bk=bl[0])),bk;al(bf,bl[0]);return bi[0];default:if(!(0)){throw Error('"assert 0" at src/compiler.coffee:144')}}};aV=function(a4,a7){var a9,a8,a1,a6,a5,a3,a2;a4.scopeNode=aR;switch(a4[0]){case"X":a1=a4[1];if(a1==="∇"){aS(a4,"Assignment to ∇ is not allowed.")}if(aY[a1]){if(aY[a1].category!==a7){aS(a4,"Inconsistent usage of symbol '"+a1+"', it is assigned both nouns and verbs.")}}else{aY[a1]={scopeDepth:aR.scopeDepth,slot:aR.nSlots++,category:a7}}break;case".":a7===O||aS(a4,"Strand assignment can be used only for nouns.");for(a8=a6=1,a3=a4.length;a6<a3;a8=a6+=1){aV(a4[a8],a7)}break;case"[":a7===O||aS(a4,"Index assignment can be used only for nouns.");aV(a4[1],a7);for(a8=a5=2,a2=a4.length;a5<a2;a8=a5+=1){if(a9=a4[a8]){aZ(a9)}}break;default:aS(a4,"Invalid LHS node type: "+(JSON.stringify(a4[0])))}return a7};for(aU=aT=1,aQ=aR.length;aT<aQ;aU=aT+=1){aZ(aR[aU])}}aP=function(bg){var bl,bh,bk,bj,bi,bm,a8,a7,bn,bf,be,bd,bc,bb,ba,a9,a6,a4,a5,a3,a2,a1;switch(bg[0]){case"B":if(bg.length===1){return[E,av.zilde,aA]}else{bl=[];for(aU=a6=1,a5=bg.length;a6<a5;aU=a6+=1){bl.push.apply(bl,aP(bg[aU]));bl.push(H)}bl[bl.length-1]=aA;return bl}break;case":":ba=aP(bg[1]);a9=aP(bg[2]);return ba.concat(h,a9.length+2,H,a9,aA);case"←":return aP(bg[2]).concat(a0(bg[1]));case"X":bn=bg[1];aY=bg.scopeNode.vars;if(((a3=(bc=aY["get_"+bn]))!=null?a3.category:void 0)===U){return[E,av.zero,q,bc.scopeDepth,bc.slot,M]}else{bc=aY[bn];return[q,bc.scopeDepth,bc.slot]}break;case"{":ba=aP(bg[1]);a8=[ao,ba.length].concat(ba);bi=(function(){switch(bg.length){case 2:return a8;case 3:a9=aP(bg[2]);a7=[ao,a9.length].concat(a9);bc=bg.scopeNode.vars["⍠"];return a7.concat(q,bc.scopeDepth,bc.slot,a8,j);default:return aS(bg)}})();if(bg.category!==U){return[ao,bi.length+1].concat(bi,aA)}else{return bi}break;case"S":bj=bg[1][0];be=bg[1].slice(1,-1).replace(RegExp(""+(bj+bj),"g"),bj);return[E,new av(be,be.length===1?[]:void 0)];case"N":bl=(function(){var bq,bp,br,bo;br=bg[1].replace(/[¯∞]/g,"-").split(/j/i);bo=[];for(bq=0,bp=br.length;bq<bp;bq++){ba=br[bq];if(ba==="-"){bo.push(Infinity)}else{if(ba==="--"){bo.push(-Infinity)}else{if(ba.match(/^-?0x/i)){bo.push(parseInt(ba,16))}else{bo.push(parseFloat(ba))}}}}return bo})();bc=bl[1]?new K(bl[0],bl[1]):bl[0];return[E,new av([bc],[])];case"J":bi=Function("return function(_w,_a){return("+(bg[1].replace(/^«|»$/g,""))+")};")();return[aL,function(bp,bo){return N(bi(bp,bo))}];case"[":bc=bg.scopeNode.vars._index;bh=[];bl=[];for(aU=a4=2,a2=bg.length;a4<a2;aU=a4+=1){if(!(bk=bg[aU])){continue}bh.push(aU-2);bl.push.apply(bl,aP(bk))}bl.push(au,bh.length,E,new av(bh),au,2,q,bc.scopeDepth,bc.slot);bl.push.apply(bl,aP(bg[1]));bl.push(j);return bl;case"V":bm=(function(){var bp,bq,bo;bo=[];for(aU=bp=1,bq=bg.length;bp<bq;aU=bp+=1){bo.push(aP(bg[aU]))}return bo})();if(aE((function(){var bq,bp,bo;bo=[];for(bq=0,bp=bm.length;bq<bp;bq++){bi=bm[bq];bo.push(bi.length===2&&bi[0]===E)}return bo})())){return[E,new av((function(){var bq,bp,bo;bo=[];for(bq=0,bp=bm.length;bq<bp;bq++){bi=bm[bq];bo.push((ba=bi[1]).isSimple()?ba.unwrap():ba)}return bo})())]}else{return(a1=[]).concat.apply(a1,r.call(bm).concat([au],[bg.length-1]))}break;case"⍬":return[E,av.zilde];case"M":return aP(bg[2]).concat(aP(bg[1]),M);case"A":return aP(bg[1]).concat(aP(bg[2]),M);case"D":case"C":return aP(bg[3]).concat(aP(bg[2]),aP(bg[1]),j);case"H":bc=bg.scopeNode.vars._hook;return aP(bg[2]).concat(q,bc.scopeDepth,bc.slot,aP(bg[1]),j);case"F":bd=bg.scopeNode.vars._hook;bc=bg.scopeNode.vars._fork1;bb=bg.scopeNode.vars._fork2;aU=bg.length-1;bf=aP(bg[aU--]);while(aU>=2){bf=bf.concat(q,bc.scopeDepth,bc.slot,aP(bg[aU--]),j,q,bb.scopeDepth,bb.slot,aP(bg[aU--]),j)}if(aU){return bf.concat(aP(bg[1]),q,bd.scopeDepth,bd.slot,j)}else{return bf}break;default:if(!(0)){throw Error('"else assert 0" at src/compiler.coffee:300')}}};a0=function(a6){var bb,a9,ba,a5,a1,bc,a8,a7,a4,a3,a2;switch(a6[0]){case"X":a1=a6[1];aY=a6.scopeNode.vars;if(((a4=(bc=aY["set_"+a1]))!=null?a4.category:void 0)===U){return[q,bc.scopeDepth,bc.slot,M]}else{bc=aY[a1];return[aw,bc.scopeDepth,bc.slot]}break;case".":a5=a6.length-1;bb=[b,a5];for(aU=a8=1,a3=a6.length;a8<a3;aU=a8+=1){bb.push.apply(bb,a0(a6[aU]));bb.push(H)}return bb;case"[":bc=a6.scopeNode.vars._substitute;a9=[];bb=[];for(aU=a7=2,a2=a6.length;a7<a2;aU=a7+=1){if(!(ba=a6[aU])){continue}a9.push(aU-2);bb.push.apply(bb,aP(ba))}bb.push(au,a9.length);bb.push.apply(bb,aP(a6[1]));bb.push(E,new av(a9),au,4,q,bc.scopeDepth,bc.slot,M);bb.push.apply(bb,a0(a6[1]));return bb;default:if(!(0)){throw Error('"assert 0" at src/compiler.coffee:335')}}};return aP(aO)};w=(function(){var aR,aQ,aP,aO,aN,aS,aT;aT={code:[1,new av([],[0],[1],0),4,0,73,9,7,22,3,1,2,3,0,65,3,1,0,3,0,29,3,1,2,6,3,0,44,5,6,8,3,0,72,3,0,44,6,4,0,44,9,7,39,7,15,3,2,0,3,1,0,5,3,1,2,3,2,2,6,8,3,0,72,7,15,3,2,0,3,1,0,5,3,1,2,3,2,0,6,8,6,8,4,0,74,9,7,173,3,1,2,3,0,62,5,3,0,62,5,3,0,16,1,new av([1],[],[],0),6,11,8,9,1,new av("RANK ERROR",[10],[1],0),3,0,61,5,8,9,3,1,0,4,1,3,9,3,1,2,7,123,3,2,0,3,0,62,5,3,0,62,5,3,0,16,1,new av([1],[],[],0),6,11,8,9,1,new av("RANK ERROR",[10],[1],0),3,0,61,5,8,9,3,2,0,3,0,13,5,4,2,0,9,3,1,3,3,0,62,5,3,0,62,5,3,0,15,3,2,0,3,0,62,5,6,11,8,9,1,new av("RANK ERROR",[10],[1],0),3,0,61,5,8,9,3,1,3,3,0,62,5,3,0,19,3,2,0,6,3,0,45,3,0,65,5,5,11,8,9,1,new av("INDEX ERROR",[11],[1],0),3,0,61,5,8,9,3,1,3,3,0,67,3,2,0,6,3,0,75,5,4,1,3,8,3,0,27,5,5,9,3,1,3,8,3,0,72,7,229,3,1,0,3,0,62,5,3,0,62,5,3,0,14,1,new av([0],[],[],0),6,11,9,9,3,1,0,3,0,70,5,8,9,3,1,0,3,0,62,5,3,0,3,3,0,65,5,5,3,0,14,1,new av([0],[],[],0),6,11,5,9,3,1,0,8,9,3,1,0,3,0,62,5,4,1,3,9,3,1,0,3,0,13,5,4,1,0,9,3,1,0,3,0,62,3,0,27,5,5,4,1,4,3,0,79,3,0,27,5,5,3,0,35,3,0,65,5,5,4,1,5,9,3,1,4,3,0,13,3,0,21,1,new av([1],[],[],0),3,0,62,3,1,5,6,6,3,0,36,3,0,26,6,3,0,37,3,0,62,6,3,0,27,5,5,4,1,4,3,0,35,3,0,65,5,5,3,0,70,5,4,1,6,9,3,1,0,7,18,3,2,0,3,0,62,3,2,2,6,3,0,70,3,1,6,6,8,3,0,27,5,3,1,4,6,3,0,76,3,0,65,5,5,3,0,70,5,3,0,62,3,1,6,3,0,13,3,1,3,6,6,8,6,4,0,75,9,7,235,3,1,2,3,0,62,5,3,0,62,5,3,0,16,1,new av([1],[],[],0),6,11,8,9,1,new av("RANK ERROR",[10],[1],0),3,0,61,5,8,9,3,1,2,3,0,13,5,4,1,3,9,3,1,0,7,46,3,2,0,3,0,62,5,3,0,62,5,3,0,14,1,new av([0],[],[],0),6,11,22,9,3,2,0,3,0,62,1,new av([1],[],[],0),3,0,62,3,1,3,3,0,62,5,6,6,8,9,3,2,0,8,5,4,1,0,9,3,1,0,3,0,62,5,3,0,62,5,3,0,17,3,1,3,3,0,62,5,6,11,8,9,1,new av("RANK ERROR",[10],[1],0),3,0,61,5,8,9,3,1,3,3,0,70,3,1,0,3,0,62,5,3,0,62,5,6,4,1,3,9,3,1,0,3,0,62,5,3,0,0,3,1,3,6,3,0,35,1,new av([0],[],[],0),6,3,0,3,1,new av([0],[],[],0),3,0,18,3,1,3,6,6,3,0,0,3,1,0,3,0,62,5,3,0,1,3,1,3,6,3,0,34,1,new av([0],[],[],0),6,3,0,3,1,new av([0],[],[],0),3,0,17,3,1,3,6,6,6,4,1,3,9,3,1,0,3,0,70,3,1,3,6,8,3,0,72,7,60,3,1,0,3,0,62,5,3,0,62,5,3,0,14,1,new av([0],[],[],0),6,11,5,9,3,1,0,8,9,3,1,0,3,1,0,3,0,62,5,3,0,62,5,3,0,0,1,new av([-1],[],[],0),6,2,1,1,new av([0],[1],[1],0),2,2,3,0,68,3,0,43,6,5,8,6,4,0,26,9,7,23,3,1,0,1,new av([0],[],[],0),2,1,1,new av([0],[1],[1],0),2,2,3,0,68,3,0,13,6,3,1,2,6,8,3,0,72,7,38,3,1,0,3,0,62,3,1,0,3,0,79,5,3,1,0,3,0,62,5,3,0,26,1,new av([1],[],[],0),6,3,0,3,3,0,65,5,5,2,2,6,8,6,4,0,76,9,7,4,3,1,0,8,4,0,77,9,7,4,3,1,2,8,3,0,72,7,3,1,new av([],[0],[1],0),8,6,4,0,78,9,7,15,3,1,0,3,0,20,3,1,2,6,3,0,44,5,8,3,0,72,7,21,1,new av([1],[],[],0),3,0,13,3,1,0,3,0,62,5,6,3,0,62,3,0,73,6,8,6,4,0,79,9,3,0,13,3,0,72,7,23,3,1,0,3,0,62,3,1,0,3,0,62,5,3,0,3,3,0,65,5,5,6,8,6,4,0,13,9,7,22,3,1,2,3,0,3,3,0,25,3,0,0,6,3,1,0,3,0,80,5,6,8,3,0,72,7,724,7,28,1,new av([0.5],[],[],0),3,0,5,3,2,0,3,0,0,5,3,0,3,3,0,25,3,0,0,6,3,2,0,6,6,8,4,1,3,9,7,290,1,new av([1],[],[],0),2,1,1,new av([0],[1],[1],0),2,2,3,0,68,3,2,0,3,0,62,5,6,4,2,3,9,3,2,3,3,0,19,1,new av([1],[],[],0),6,11,43,9,3,2,0,7,35,3,3,0,3,0,13,5,3,1,3,5,4,3,3,9,3,3,3,3,0,4,3,3,0,6,3,3,3,3,0,76,5,2,2,8,5,8,9,1,new av([2],[],[],0),3,0,4,3,2,3,6,3,0,35,5,4,2,4,9,3,2,0,3,0,70,3,2,4,3,0,13,3,2,0,3,0,62,5,3,0,70,1,new av([1],[],[],0),6,6,6,4,2,5,9,3,2,0,3,0,26,3,2,4,3,0,13,1,new av([0],[],[],0),6,6,4,2,6,9,3,2,5,3,2,1,5,10,2,4,2,7,9,4,2,8,9,9,3,2,6,3,0,3,3,0,25,3,0,0,6,3,2,7,3,0,71,5,3,0,0,5,6,4,2,9,9,3,2,9,3,0,3,3,0,25,3,0,0,6,3,2,7,6,3,0,1,3,2,6,6,3,2,1,5,10,2,4,2,10,9,4,2,11,9,9,3,2,10,3,0,13,3,2,7,6,3,2,11,3,0,70,3,2,3,3,0,1,5,3,0,13,1,new av([2],[],[],0),3,0,4,3,2,3,6,3,0,34,5,6,6,3,0,76,3,2,9,3,0,13,3,2,8,6,6,2,2,8,4,1,4,9,7,214,3,2,0,3,0,62,5,3,0,70,1,new av([1],[],[],0),6,4,2,3,3,0,14,1,new av([1],[],[],0),6,11,9,9,3,2,0,3,0,4,5,8,9,1,new av([2],[],[],0),3,0,4,3,2,3,6,3,0,35,5,4,2,4,9,3,2,0,3,0,70,3,2,4,3,0,13,3,2,4,6,6,3,2,1,5,4,2,5,9,3,2,0,3,0,26,3,2,4,3,0,13,3,2,4,6,6,3,2,1,5,4,2,6,9,3,2,0,3,0,70,3,2,3,3,0,1,3,2,4,6,3,0,13,3,2,4,6,6,4,2,7,9,3,2,6,3,0,3,3,0,25,3,0,0,6,3,2,7,6,3,0,3,3,0,25,3,0,0,6,3,2,5,6,3,0,1,5,4,2,8,9,3,2,6,3,0,70,3,2,3,3,0,1,5,3,0,13,1,new av([2],[],[],0),3,0,4,3,2,3,6,3,0,34,5,6,6,3,0,76,3,2,8,3,0,13,3,2,5,6,6,8,4,1,5,9,3,1,0,3,0,62,5,3,0,62,5,3,0,14,1,new av([0],[],[],0),6,11,9,9,3,1,0,3,0,4,5,8,9,3,1,0,3,0,62,5,3,0,62,5,3,0,14,1,new av([1],[],[],0),6,11,17,9,3,1,0,3,0,76,5,3,1,1,5,3,0,13,5,8,9,3,1,0,3,0,62,5,3,0,62,5,3,0,15,1,new av([2],[],[],0),6,11,8,9,1,new av("RANK ERROR",[10],[1],0),3,0,61,5,8,9,3,1,0,3,0,62,5,3,0,19,3,0,65,5,5,3,0,29,1,new av([0],[],[],0),6,11,8,9,1,new av("LENGTH ERROR",[12],[1],0),3,0,61,5,8,9,3,1,0,3,1,4,5,10,2,4,1,6,9,4,1,7,9,9,3,1,6,3,0,71,5,3,0,0,5,3,0,3,3,0,25,3,0,0,6,3,1,7,3,1,5,5,6,8,6,4,0,80,9,7,31,7,11,3,2,2,3,1,0,3,2,0,6,8,3,0,72,7,11,3,2,0,3,1,0,3,2,0,6,8,6,8,4,0,81,9,3,0,1,4,0,2,9,3,0,5,4,0,6,9,3,0,8,4,0,9,9,3,0,46,4,0,47,9,3,0,29,4,0,30,8],nSlots:82,vars:{"+":{category:2,slot:0,scopeDepth:0},"-":{category:2,slot:1,scopeDepth:0},"−":{category:2,slot:2,scopeDepth:0},"×":{category:2,slot:3,scopeDepth:0},"÷":{category:2,slot:4,scopeDepth:0},"*":{category:2,slot:5,scopeDepth:0},"⋆":{category:2,slot:6,scopeDepth:0},"⍟":{category:2,slot:7,scopeDepth:0},"|":{category:2,slot:8,scopeDepth:0},"∣":{category:2,slot:9,scopeDepth:0},"\\":{category:3,slot:10,scopeDepth:0},"⍀":{category:3,slot:11,scopeDepth:0},"○":{category:2,slot:12,scopeDepth:0},",":{category:2,slot:13,scopeDepth:0},"=":{category:2,slot:14,scopeDepth:0},"≠":{category:2,slot:15,scopeDepth:0},"<":{category:2,slot:16,scopeDepth:0},">":{category:2,slot:17,scopeDepth:0},"≤":{category:2,slot:18,scopeDepth:0},"≥":{category:2,slot:19,scopeDepth:0},"≡":{category:2,slot:20,scopeDepth:0},"∘":{category:4,slot:21,scopeDepth:0},"∪":{category:2,slot:22,scopeDepth:0},"∩":{category:2,slot:23,scopeDepth:0},"⊥":{category:2,slot:24,scopeDepth:0},".":{category:4,slot:25,scopeDepth:0},"↓":{category:2,slot:26,scopeDepth:0},"¨":{category:3,slot:27,scopeDepth:0},"⊤":{category:2,slot:28,scopeDepth:0},"∊":{category:2,slot:29,scopeDepth:0},"∈":{category:2,slot:30,scopeDepth:0},"!":{category:2,slot:31,scopeDepth:0},"⍎":{category:2,slot:32,scopeDepth:0},"⍷":{category:2,slot:33,scopeDepth:0},"⌊":{category:2,slot:34,scopeDepth:0},"⌈":{category:2,slot:35,scopeDepth:0},_fork1:{category:2,slot:36,scopeDepth:0},_fork2:{category:2,slot:37,scopeDepth:0},"⍕":{category:2,slot:38,scopeDepth:0},"⍋":{category:2,slot:39,scopeDepth:0},"⍒":{category:2,slot:40,scopeDepth:0},"⍁":{category:4,slot:41,scopeDepth:0},"⍳":{category:2,slot:42,scopeDepth:0},"⊂":{category:2,slot:43,scopeDepth:0},"~":{category:2,slot:44,scopeDepth:0},"∨":{category:2,slot:45,scopeDepth:0},"∧":{category:2,slot:46,scopeDepth:0},"^":{category:2,slot:47,scopeDepth:0},"⍱":{category:2,slot:48,scopeDepth:0},"⍲":{category:2,slot:49,scopeDepth:0},"⍣":{category:4,slot:50,scopeDepth:0},"get_⎕":{category:2,slot:51,scopeDepth:0},"⎕":{category:1},"set_⎕":{category:2,slot:52,scopeDepth:0},"get_⍞":{category:2,slot:53,scopeDepth:0},"⍞":{category:1},"set_⍞":{category:2,slot:54,scopeDepth:0},"get_⎕IO":{category:2,slot:55,scopeDepth:0},"⎕IO":{category:1},"set_⎕IO":{category:2,slot:56,scopeDepth:0},"⎕DL":{category:2,slot:57,scopeDepth:0},"⎕RE":{category:2,slot:58,scopeDepth:0},"⎕UCS":{category:2,slot:59,scopeDepth:0},"?":{category:2,slot:60,scopeDepth:0},"↗":{category:2,slot:61,scopeDepth:0},"⍴":{category:2,slot:62,scopeDepth:0},"⌽":{category:2,slot:63,scopeDepth:0},"⊖":{category:2,slot:64,scopeDepth:0},"/":{category:3,slot:65,scopeDepth:0},"⌿":{category:3,slot:66,scopeDepth:0},"⌷":{category:2,slot:67,scopeDepth:0},_index:{category:2,slot:68,scopeDepth:0},_substitute:{category:2,slot:69,scopeDepth:0},"↑":{category:2,slot:70,scopeDepth:0},"⍉":{category:2,slot:71,scopeDepth:0},"⍠":{category:4,slot:72,scopeDepth:0},"⍬":{scopeDepth:0,slot:73,category:1},_hook:{scopeDepth:0,slot:74,category:4},"⊃":{scopeDepth:0,slot:75,category:2},"⍪":{scopeDepth:0,slot:76,category:2},"⊢":{scopeDepth:0,slot:77,category:2},"⊣":{scopeDepth:0,slot:78,category:2},"≢":{scopeDepth:0,slot:79,category:2},"⌹":{scopeDepth:0,slot:80,category:2},"⍨":{scopeDepth:0,slot:81,category:3}}},aR=aT.code,aO=aT.nSlots,aS=aT.vars;aQ=[[]];for(aP in aS){aN=aS[aP];aQ[0][aN.slot]=B[aP]}J({code:aR,env:aQ});for(aP in aS){aN=aS[aP];B[aP]=aQ[0][aN.slot]}return{nSlots:aO,vars:aS,env:aQ}})();N=function(aN){var aO;if(typeof aN==="string"){if(aN.length===1){return av.scalar(aN)}else{return new av(aN)}}else{if(typeof aN==="number"){return av.scalar(aN)}else{if(aN instanceof Array){return new av((function(){var aR,aQ,aP;aP=[];for(aR=0,aQ=aN.length;aR<aQ;aR++){aO=aN[aR];aP.push((aO=N(aO),aO.shape.length?aO:aO.unwrap()))}return aP})())}else{if(aN instanceof av){return aN}else{return aG("Cannot aplify object "+aN)}}}}};this.apl=A=function(aN,aO){return(A.ws(aO))(aN)};al(A,{format:x,approx:ar,parse:an,compileAST:a,repr:f});A.ws=function(aO){var aN;if(aO==null){aO={}}aN=Object.create(B);if(aO["in"]){aN["get_⎕"]=aN["get_⍞"]=function(){var aP;aP=aO["in"]();if(!(typeof aP==="string")){throw Error("\"if opts.in then ctx['get_⎕'] = ctx['get_⍞'] = -> s = opts.in(); assert typeof s is 'string'; new APLArray s\" at /tmp/apl/src/apl.coffee:60")}return new av(aP)}}if(aO.out){aN["set_⎕"]=aN["set_⍞"]=function(aP){return aO.out(x(aP).join("\n")+"\n")}}return function(aP){return aI(aP,{ctx:aN})}};if(typeof module!=="undefined"&&module!==null){module.exports=A;if(module===(typeof require!=="undefined"&&require!==null?require.main:void 0)){(function(){var aW,aU,aO,aP,aS,aT,aR,aQ,aV,aN;aT="Usage: apl.js filename.apl\n";aO=null;aN=process.argv.slice(2);for(aQ=0,aV=aN.length;aQ<aV;aQ++){aW=aN[aQ];if(aW==="-h"||aW==="--help"){process.stderr.write(aT);process.exit(0)}else{if(/^-/.test(aW)){process.stderr.write("unrecognized option: "+aW+"\n"+aT);process.exit(1)}else{if(aO!=null){process.stderr.write(aT);process.exit(1)}else{aO=aW}}}}if(aO!=null){aI(require("fs").readFileSync(aO,"utf8"))}else{if(!require("tty").isatty()){aI(Buffer.concat((function(){var aX;aX=[];while(true){aU=new Buffer(1024);if(!(aP=require("fs").readSync(0,aU,0,aU.length,null))){break}aX.push(aU.slice(0,aP))}return aX})()).toString("utf8"))}else{process.stdout.write("ngn apl 2013-12-30\n");aS=require("readline").createInterface(process.stdin,process.stdout);aS.setPrompt("      ");aR=A.ws();aS.on("line",function(aX){var aY;try{if(!aX.match(/^[\ \t\f\r\n]*$/)){process.stdout.write(x(aR(aX)).join("\n")+"\n")}}catch(aZ){aY=aZ;process.stdout.write(aY+"\n")}aS.prompt()});aS.on("close",function(){process.stdout.write("\n");return process.exit(0)});aS.prompt()}}})()}}}).call(this);